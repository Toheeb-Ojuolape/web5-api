(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.IpfsUnixfsImporter = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var IpfsUnixfsImporter=(()=>{var oi=Object.create;var Rt=Object.defineProperty;var si=Object.getOwnPropertyDescriptor;var ai=Object.getOwnPropertyNames;var ci=Object.getPrototypeOf,fi=Object.prototype.hasOwnProperty;var C=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports),P=(r,t)=>{for(var e in t)Rt(r,e,{get:t[e],enumerable:!0})},ir=(r,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of ai(t))!fi.call(r,i)&&i!==e&&Rt(r,i,{get:()=>t[i],enumerable:!(n=si(t,i))||n.enumerable});return r};var O=(r,t,e)=>(e=r!=null?oi(ci(r)):{},ir(t||!r||!r.__esModule?Rt(e,"default",{value:r,enumerable:!0}):e,r)),ui=r=>ir(Rt({},"__esModule",{value:!0}),r);var _t=C((Ns,sr)=>{"use strict";function or(r,t){for(let e in t)Object.defineProperty(r,e,{value:t[e],enumerable:!0,configurable:!0});return r}function di(r,t,e){if(!r||typeof r=="string")throw new TypeError("Please pass an Error to err-code");e||(e={}),typeof t=="object"&&(e=t,t=""),t&&(e.code=t);try{return or(r,e)}catch{e.message=r.message,e.stack=r.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(r)),or(new i,e)}}sr.exports=di});var cr=C((Cs,ar)=>{"use strict";ar.exports=pi;function pi(r,t){for(var e=new Array(arguments.length-1),n=0,i=2,o=!0;i<arguments.length;)e[n++]=arguments[i++];return new Promise(function(f,a){e[n]=function(u){if(o)if(o=!1,u)a(u);else{for(var p=new Array(arguments.length-1),D=0;D<p.length;)p[D++]=arguments[D];f.apply(null,p)}};try{r.apply(t||null,e)}catch(h){o&&(o=!1,a(h))}})}});var lr=C(hr=>{"use strict";var Vt=hr;Vt.length=function(t){var e=t.length;if(!e)return 0;for(var n=0;--e%4>1&&t.charAt(e)==="=";)++n;return Math.ceil(t.length*3)/4-n};var ut=new Array(64),ur=new Array(123);for(R=0;R<64;)ur[ut[R]=R<26?R+65:R<52?R+71:R<62?R-4:R-59|43]=R++;var R;Vt.encode=function(t,e,n){for(var i=null,o=[],s=0,f=0,a;e<n;){var h=t[e++];switch(f){case 0:o[s++]=ut[h>>2],a=(h&3)<<4,f=1;break;case 1:o[s++]=ut[a|h>>4],a=(h&15)<<2,f=2;break;case 2:o[s++]=ut[a|h>>6],o[s++]=ut[h&63],f=0;break}s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),s=0)}return f&&(o[s++]=ut[a],o[s++]=61,f===1&&(o[s++]=61)),i?(s&&i.push(String.fromCharCode.apply(String,o.slice(0,s))),i.join("")):String.fromCharCode.apply(String,o.slice(0,s))};var fr="invalid encoding";Vt.decode=function(t,e,n){for(var i=n,o=0,s,f=0;f<t.length;){var a=t.charCodeAt(f++);if(a===61&&o>1)break;if((a=ur[a])===void 0)throw Error(fr);switch(o){case 0:s=a,o=1;break;case 1:e[n++]=s<<2|(a&48)>>4,s=a,o=2;break;case 2:e[n++]=(s&15)<<4|(a&60)>>2,s=a,o=3;break;case 3:e[n++]=(s&3)<<6|a,o=0;break}}if(o===1)throw Error(fr);return n-i};Vt.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)}});var pr=C((zs,dr)=>{"use strict";dr.exports=qt;function qt(){this._listeners={}}qt.prototype.on=function(t,e,n){return(this._listeners[t]||(this._listeners[t]=[])).push({fn:e,ctx:n||this}),this};qt.prototype.off=function(t,e){if(t===void 0)this._listeners={};else if(e===void 0)this._listeners[t]=[];else for(var n=this._listeners[t],i=0;i<n.length;)n[i].fn===e?n.splice(i,1):++i;return this};qt.prototype.emit=function(t){var e=this._listeners[t];if(e){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<e.length;)e[i].fn.apply(e[i++].ctx,n)}return this}});var _r=C((Is,xr)=>{"use strict";xr.exports=mr(mr);function mr(r){return typeof Float32Array<"u"?function(){var t=new Float32Array([-0]),e=new Uint8Array(t.buffer),n=e[3]===128;function i(a,h,u){t[0]=a,h[u]=e[0],h[u+1]=e[1],h[u+2]=e[2],h[u+3]=e[3]}function o(a,h,u){t[0]=a,h[u]=e[3],h[u+1]=e[2],h[u+2]=e[1],h[u+3]=e[0]}r.writeFloatLE=n?i:o,r.writeFloatBE=n?o:i;function s(a,h){return e[0]=a[h],e[1]=a[h+1],e[2]=a[h+2],e[3]=a[h+3],t[0]}function f(a,h){return e[3]=a[h],e[2]=a[h+1],e[1]=a[h+2],e[0]=a[h+3],t[0]}r.readFloatLE=n?s:f,r.readFloatBE=n?f:s}():function(){function t(n,i,o,s){var f=i<0?1:0;if(f&&(i=-i),i===0)n(1/i>0?0:2147483648,o,s);else if(isNaN(i))n(2143289344,o,s);else if(i>34028234663852886e22)n((f<<31|2139095040)>>>0,o,s);else if(i<11754943508222875e-54)n((f<<31|Math.round(i/1401298464324817e-60))>>>0,o,s);else{var a=Math.floor(Math.log(i)/Math.LN2),h=Math.round(i*Math.pow(2,-a)*8388608)&8388607;n((f<<31|a+127<<23|h)>>>0,o,s)}}r.writeFloatLE=t.bind(null,yr),r.writeFloatBE=t.bind(null,gr);function e(n,i,o){var s=n(i,o),f=(s>>31)*2+1,a=s>>>23&255,h=s&8388607;return a===255?h?NaN:f*(1/0):a===0?f*1401298464324817e-60*h:f*Math.pow(2,a-150)*(h+8388608)}r.readFloatLE=e.bind(null,wr),r.readFloatBE=e.bind(null,br)}(),typeof Float64Array<"u"?function(){var t=new Float64Array([-0]),e=new Uint8Array(t.buffer),n=e[7]===128;function i(a,h,u){t[0]=a,h[u]=e[0],h[u+1]=e[1],h[u+2]=e[2],h[u+3]=e[3],h[u+4]=e[4],h[u+5]=e[5],h[u+6]=e[6],h[u+7]=e[7]}function o(a,h,u){t[0]=a,h[u]=e[7],h[u+1]=e[6],h[u+2]=e[5],h[u+3]=e[4],h[u+4]=e[3],h[u+5]=e[2],h[u+6]=e[1],h[u+7]=e[0]}r.writeDoubleLE=n?i:o,r.writeDoubleBE=n?o:i;function s(a,h){return e[0]=a[h],e[1]=a[h+1],e[2]=a[h+2],e[3]=a[h+3],e[4]=a[h+4],e[5]=a[h+5],e[6]=a[h+6],e[7]=a[h+7],t[0]}function f(a,h){return e[7]=a[h],e[6]=a[h+1],e[5]=a[h+2],e[4]=a[h+3],e[3]=a[h+4],e[2]=a[h+5],e[1]=a[h+6],e[0]=a[h+7],t[0]}r.readDoubleLE=n?s:f,r.readDoubleBE=n?f:s}():function(){function t(n,i,o,s,f,a){var h=s<0?1:0;if(h&&(s=-s),s===0)n(0,f,a+i),n(1/s>0?0:2147483648,f,a+o);else if(isNaN(s))n(0,f,a+i),n(2146959360,f,a+o);else if(s>17976931348623157e292)n(0,f,a+i),n((h<<31|2146435072)>>>0,f,a+o);else{var u;if(s<22250738585072014e-324)u=s/5e-324,n(u>>>0,f,a+i),n((h<<31|u/4294967296)>>>0,f,a+o);else{var p=Math.floor(Math.log(s)/Math.LN2);p===1024&&(p=1023),u=s*Math.pow(2,-p),n(u*4503599627370496>>>0,f,a+i),n((h<<31|p+1023<<20|u*1048576&1048575)>>>0,f,a+o)}}}r.writeDoubleLE=t.bind(null,yr,0,4),r.writeDoubleBE=t.bind(null,gr,4,0);function e(n,i,o,s,f){var a=n(s,f+i),h=n(s,f+o),u=(h>>31)*2+1,p=h>>>20&2047,D=4294967296*(h&1048575)+a;return p===2047?D?NaN:u*(1/0):p===0?u*5e-324*D:u*Math.pow(2,p-1075)*(D+4503599627370496)}r.readDoubleLE=e.bind(null,wr,0,4),r.readDoubleBE=e.bind(null,br,4,0)}(),r}function yr(r,t,e){t[e]=r&255,t[e+1]=r>>>8&255,t[e+2]=r>>>16&255,t[e+3]=r>>>24}function gr(r,t,e){t[e]=r>>>24,t[e+1]=r>>>16&255,t[e+2]=r>>>8&255,t[e+3]=r&255}function wr(r,t){return(r[t]|r[t+1]<<8|r[t+2]<<16|r[t+3]<<24)>>>0}function br(r,t){return(r[t]<<24|r[t+1]<<16|r[t+2]<<8|r[t+3])>>>0}});var vr=C((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(r){}return null}});var Ar=C(Br=>{"use strict";var ne=Br;ne.length=function(t){for(var e=0,n=0,i=0;i<t.length;++i)n=t.charCodeAt(i),n<128?e+=1:n<2048?e+=2:(n&64512)===55296&&(t.charCodeAt(i+1)&64512)===56320?(++i,e+=4):e+=3;return e};ne.read=function(t,e,n){var i=n-e;if(i<1)return"";for(var o=null,s=[],f=0,a;e<n;)a=t[e++],a<128?s[f++]=a:a>191&&a<224?s[f++]=(a&31)<<6|t[e++]&63:a>239&&a<365?(a=((a&7)<<18|(t[e++]&63)<<12|(t[e++]&63)<<6|t[e++]&63)-65536,s[f++]=55296+(a>>10),s[f++]=56320+(a&1023)):s[f++]=(a&15)<<12|(t[e++]&63)<<6|t[e++]&63,f>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),f=0);return o?(f&&o.push(String.fromCharCode.apply(String,s.slice(0,f))),o.join("")):String.fromCharCode.apply(String,s.slice(0,f))};ne.write=function(t,e,n){for(var i=n,o,s,f=0;f<t.length;++f)o=t.charCodeAt(f),o<128?e[n++]=o:o<2048?(e[n++]=o>>6|192,e[n++]=o&63|128):(o&64512)===55296&&((s=t.charCodeAt(f+1))&64512)===56320?(o=65536+((o&1023)<<10)+(s&1023),++f,e[n++]=o>>18|240,e[n++]=o>>12&63|128,e[n++]=o>>6&63|128,e[n++]=o&63|128):(e[n++]=o>>12|224,e[n++]=o>>6&63|128,e[n++]=o&63|128);return n-i}});var Sr=C((Us,kr)=>{"use strict";kr.exports=mi;function mi(r,t,e){var n=e||8192,i=n>>>1,o=null,s=n;return function(a){if(a<1||a>i)return r(a);s+a>n&&(o=r(n),s=0);var h=t.call(o,s,s+=a);return s&7&&(s=(s|7)+1),h}}});var Er=C((Ms,Dr)=>{"use strict";Dr.exports=N;var vt=nt();function N(r,t){this.lo=r>>>0,this.hi=t>>>0}var rt=N.zero=new N(0,0);rt.toNumber=function(){return 0};rt.zzEncode=rt.zzDecode=function(){return this};rt.length=function(){return 1};var yi=N.zeroHash="\0\0\0\0\0\0\0\0";N.fromNumber=function(t){if(t===0)return rt;var e=t<0;e&&(t=-t);var n=t>>>0,i=(t-n)/4294967296>>>0;return e&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new N(n,i)};N.from=function(t){if(typeof t=="number")return N.fromNumber(t);if(vt.isString(t))if(vt.Long)t=vt.Long.fromString(t);else return N.fromNumber(parseInt(t,10));return t.low||t.high?new N(t.low>>>0,t.high>>>0):rt};N.prototype.toNumber=function(t){if(!t&&this.hi>>>31){var e=~this.lo+1>>>0,n=~this.hi>>>0;return e||(n=n+1>>>0),-(e+n*4294967296)}return this.lo+this.hi*4294967296};N.prototype.toLong=function(t){return vt.Long?new vt.Long(this.lo|0,this.hi|0,!!t):{low:this.lo|0,high:this.hi|0,unsigned:!!t}};var Y=String.prototype.charCodeAt;N.fromHash=function(t){return t===yi?rt:new N((Y.call(t,0)|Y.call(t,1)<<8|Y.call(t,2)<<16|Y.call(t,3)<<24)>>>0,(Y.call(t,4)|Y.call(t,5)<<8|Y.call(t,6)<<16|Y.call(t,7)<<24)>>>0)};N.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};N.prototype.zzEncode=function(){var t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this};N.prototype.zzDecode=function(){var t=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this};N.prototype.length=function(){var t=this.lo,e=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?e===0?t<16384?t<128?1:2:t<2097152?3:4:e<16384?e<128?5:6:e<2097152?7:8:n<128?9:10}});var nt=C(ie=>{"use strict";var x=ie;x.asPromise=cr();x.base64=lr();x.EventEmitter=pr();x.float=_r();x.inquire=vr();x.utf8=Ar();x.pool=Sr();x.LongBits=Er();x.isNode=!!(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);x.global=x.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||ie;x.emptyArray=Object.freeze?Object.freeze([]):[];x.emptyObject=Object.freeze?Object.freeze({}):{};x.isInteger=Number.isInteger||function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t};x.isString=function(t){return typeof t=="string"||t instanceof String};x.isObject=function(t){return t&&typeof t=="object"};x.isset=x.isSet=function(t,e){var n=t[e];return n!=null&&t.hasOwnProperty(e)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};x.Buffer=function(){try{var r=x.inquire("buffer").Buffer;return r.prototype.utf8Write?r:null}catch{return null}}();x._Buffer_from=null;x._Buffer_allocUnsafe=null;x.newBuffer=function(t){return typeof t=="number"?x.Buffer?x._Buffer_allocUnsafe(t):new x.Array(t):x.Buffer?x._Buffer_from(t):typeof Uint8Array>"u"?t:new Uint8Array(t)};x.Array=typeof Uint8Array<"u"?Uint8Array:Array;x.Long=x.global.dcodeIO&&x.global.dcodeIO.Long||x.global.Long||x.inquire("long");x.key2Re=/^true|false|0|1$/;x.key32Re=/^-?(?:0|[1-9][0-9]*)$/;x.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;x.longToHash=function(t){return t?x.LongBits.from(t).toHash():x.LongBits.zeroHash};x.longFromHash=function(t,e){var n=x.LongBits.fromHash(t);return x.Long?x.Long.fromBits(n.lo,n.hi,e):n.toNumber(!!e)};function Lr(r,t,e){for(var n=Object.keys(t),i=0;i<n.length;++i)(r[n[i]]===void 0||!e)&&(r[n[i]]=t[n[i]]);return r}x.merge=Lr;x.lcFirst=function(t){return t.charAt(0).toLowerCase()+t.substring(1)};function Tr(r){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&Lr(this,n)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return r},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}x.newError=Tr;x.ProtocolError=Tr("ProtocolError");x.oneOfGetter=function(t){for(var e={},n=0;n<t.length;++n)e[t[n]]=1;return function(){for(var i=Object.keys(this),o=i.length-1;o>-1;--o)if(e[i[o]]===1&&this[i[o]]!==void 0&&this[i[o]]!==null)return i[o]}};x.oneOfSetter=function(t){return function(e){for(var n=0;n<t.length;++n)t[n]!==e&&delete this[t[n]]}};x.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};x._configure=function(){var r=x.Buffer;if(!r){x._Buffer_from=x._Buffer_allocUnsafe=null;return}x._Buffer_from=r.from!==Uint8Array.from&&r.from||function(e,n){return new r(e,n)},x._Buffer_allocUnsafe=r.allocUnsafe||function(e){return new r(e)}}});var ae=C((Os,Ir)=>{"use strict";Ir.exports=T;var j=nt(),se,Pr=j.LongBits,gi=j.utf8;function V(r,t){return RangeError("index out of range: "+r.pos+" + "+(t||1)+" > "+r.len)}function T(r){this.buf=r,this.pos=0,this.len=r.length}var Nr=typeof Uint8Array<"u"?function(t){if(t instanceof Uint8Array||Array.isArray(t))return new T(t);throw Error("illegal buffer")}:function(t){if(Array.isArray(t))return new T(t);throw Error("illegal buffer")},zr=function(){return j.Buffer?function(e){return(T.create=function(i){return j.Buffer.isBuffer(i)?new se(i):Nr(i)})(e)}:Nr};T.create=zr();T.prototype._slice=j.Array.prototype.subarray||j.Array.prototype.slice;T.prototype.uint32=function(){var t=4294967295;return function(){if(t=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(t=(t|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return t;if((this.pos+=5)>this.len)throw this.pos=this.len,V(this,10);return t}}();T.prototype.int32=function(){return this.uint32()|0};T.prototype.sint32=function(){var t=this.uint32();return t>>>1^-(t&1)|0};function oe(){var r=new Pr(0,0),t=0;if(this.len-this.pos>4){for(;t<4;++t)if(r.lo=(r.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return r;if(r.lo=(r.lo|(this.buf[this.pos]&127)<<28)>>>0,r.hi=(r.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return r;t=0}else{for(;t<3;++t){if(this.pos>=this.len)throw V(this);if(r.lo=(r.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return r}return r.lo=(r.lo|(this.buf[this.pos++]&127)<<t*7)>>>0,r}if(this.len-this.pos>4){for(;t<5;++t)if(r.hi=(r.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return r}else for(;t<5;++t){if(this.pos>=this.len)throw V(this);if(r.hi=(r.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return r}throw Error("invalid varint encoding")}T.prototype.bool=function(){return this.uint32()!==0};function Gt(r,t){return(r[t-4]|r[t-3]<<8|r[t-2]<<16|r[t-1]<<24)>>>0}T.prototype.fixed32=function(){if(this.pos+4>this.len)throw V(this,4);return Gt(this.buf,this.pos+=4)};T.prototype.sfixed32=function(){if(this.pos+4>this.len)throw V(this,4);return Gt(this.buf,this.pos+=4)|0};function Cr(){if(this.pos+8>this.len)throw V(this,8);return new Pr(Gt(this.buf,this.pos+=4),Gt(this.buf,this.pos+=4))}T.prototype.float=function(){if(this.pos+4>this.len)throw V(this,4);var t=j.float.readFloatLE(this.buf,this.pos);return this.pos+=4,t};T.prototype.double=function(){if(this.pos+8>this.len)throw V(this,4);var t=j.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,t};T.prototype.bytes=function(){var t=this.uint32(),e=this.pos,n=this.pos+t;if(n>this.len)throw V(this,t);return this.pos+=t,Array.isArray(this.buf)?this.buf.slice(e,n):e===n?new this.buf.constructor(0):this._slice.call(this.buf,e,n)};T.prototype.string=function(){var t=this.bytes();return gi.read(t,0,t.length)};T.prototype.skip=function(t){if(typeof t=="number"){if(this.pos+t>this.len)throw V(this,t);this.pos+=t}else do if(this.pos>=this.len)throw V(this);while(this.buf[this.pos++]&128);return this};T.prototype.skipType=function(r){switch(r){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(r=this.uint32()&7)!==4;)this.skipType(r);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+r+" at offset "+this.pos)}return this};T._configure=function(r){se=r,T.create=zr(),se._configure();var t=j.Long?"toLong":"toNumber";j.merge(T.prototype,{int64:function(){return oe.call(this)[t](!1)},uint64:function(){return oe.call(this)[t](!0)},sint64:function(){return oe.call(this).zzDecode()[t](!1)},fixed64:function(){return Cr.call(this)[t](!0)},sfixed64:function(){return Cr.call(this)[t](!1)}})}});var Hr=C((Rs,Mr)=>{"use strict";Mr.exports=it;var Ur=ae();(it.prototype=Object.create(Ur.prototype)).constructor=it;var Fr=nt();function it(r){Ur.call(this,r)}it._configure=function(){Fr.Buffer&&(it.prototype._slice=Fr.Buffer.prototype.slice)};it.prototype.string=function(){var t=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+t,this.len))};it._configure()});var pe=C((Vs,qr)=>{"use strict";qr.exports=A;var M=nt(),ce,jt=M.LongBits,Or=M.base64,Rr=M.utf8;function Bt(r,t,e){this.fn=r,this.len=t,this.next=void 0,this.val=e}function ue(){}function wi(r){this.head=r.head,this.tail=r.tail,this.len=r.len,this.next=r.states}function A(){this.len=0,this.head=new Bt(ue,0,0),this.tail=this.head,this.states=null}var Vr=function(){return M.Buffer?function(){return(A.create=function(){return new ce})()}:function(){return new A}};A.create=Vr();A.alloc=function(t){return new M.Array(t)};M.Array!==Array&&(A.alloc=M.pool(A.alloc,M.Array.prototype.subarray));A.prototype._push=function(t,e,n){return this.tail=this.tail.next=new Bt(t,e,n),this.len+=e,this};function he(r,t,e){t[e]=r&255}function bi(r,t,e){for(;r>127;)t[e++]=r&127|128,r>>>=7;t[e]=r}function le(r,t){this.len=r,this.next=void 0,this.val=t}le.prototype=Object.create(Bt.prototype);le.prototype.fn=bi;A.prototype.uint32=function(t){return this.len+=(this.tail=this.tail.next=new le((t=t>>>0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this};A.prototype.int32=function(t){return t<0?this._push(de,10,jt.fromNumber(t)):this.uint32(t)};A.prototype.sint32=function(t){return this.uint32((t<<1^t>>31)>>>0)};function de(r,t,e){for(;r.hi;)t[e++]=r.lo&127|128,r.lo=(r.lo>>>7|r.hi<<25)>>>0,r.hi>>>=7;for(;r.lo>127;)t[e++]=r.lo&127|128,r.lo=r.lo>>>7;t[e++]=r.lo}A.prototype.uint64=function(t){var e=jt.from(t);return this._push(de,e.length(),e)};A.prototype.int64=A.prototype.uint64;A.prototype.sint64=function(t){var e=jt.from(t).zzEncode();return this._push(de,e.length(),e)};A.prototype.bool=function(t){return this._push(he,1,t?1:0)};function fe(r,t,e){t[e]=r&255,t[e+1]=r>>>8&255,t[e+2]=r>>>16&255,t[e+3]=r>>>24}A.prototype.fixed32=function(t){return this._push(fe,4,t>>>0)};A.prototype.sfixed32=A.prototype.fixed32;A.prototype.fixed64=function(t){var e=jt.from(t);return this._push(fe,4,e.lo)._push(fe,4,e.hi)};A.prototype.sfixed64=A.prototype.fixed64;A.prototype.float=function(t){return this._push(M.float.writeFloatLE,4,t)};A.prototype.double=function(t){return this._push(M.float.writeDoubleLE,8,t)};var xi=M.Array.prototype.set?function(t,e,n){e.set(t,n)}:function(t,e,n){for(var i=0;i<t.length;++i)e[n+i]=t[i]};A.prototype.bytes=function(t){var e=t.length>>>0;if(!e)return this._push(he,1,0);if(M.isString(t)){var n=A.alloc(e=Or.length(t));Or.decode(t,n,0),t=n}return this.uint32(e)._push(xi,e,t)};A.prototype.string=function(t){var e=Rr.length(t);return e?this.uint32(e)._push(Rr.write,e,t):this._push(he,1,0)};A.prototype.fork=function(){return this.states=new wi(this),this.head=this.tail=new Bt(ue,0,0),this.len=0,this};A.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Bt(ue,0,0),this.len=0),this};A.prototype.ldelim=function(){var t=this.head,e=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=t.next,this.tail=e,this.len+=n),this};A.prototype.finish=function(){for(var t=this.head.next,e=this.constructor.alloc(this.len),n=0;t;)t.fn(t.val,e,n),n+=t.len,t=t.next;return e};A._configure=function(r){ce=r,A.create=Vr(),ce._configure()}});var $r=C((qs,jr)=>{"use strict";jr.exports=$;var Gr=pe();($.prototype=Object.create(Gr.prototype)).constructor=$;var tt=nt();function $(){Gr.call(this)}$._configure=function(){$.alloc=tt._Buffer_allocUnsafe,$.writeBytesBuffer=tt.Buffer&&tt.Buffer.prototype instanceof Uint8Array&&tt.Buffer.prototype.set.name==="set"?function(t,e,n){e.set(t,n)}:function(t,e,n){if(t.copy)t.copy(e,n,0,t.length);else for(var i=0;i<t.length;)e[n++]=t[i++]}};$.prototype.bytes=function(t){tt.isString(t)&&(t=tt._Buffer_from(t,"base64"));var e=t.length>>>0;return this.uint32(e),e&&this._push($.writeBytesBuffer,e,t),this};function _i(r,t,e){r.length<40?tt.utf8.write(r,t,e):t.utf8Write?t.utf8Write(r,e):t.write(r,e)}$.prototype.string=function(t){var e=tt.Buffer.byteLength(t);return this.uint32(e),e&&this._push(_i,e,t),this};$._configure()});var Nn=C((sc,Tn)=>{"use strict";Tn.exports=class{constructor(){this._bitArrays=[],this._data=[],this._length=0,this._changedLength=!1,this._changedData=!1}set(t,e){let n=this._internalPositionFor(t,!1);if(e===void 0)n!==-1&&(this._unsetInternalPos(n),this._unsetBit(t),this._changedLength=!0,this._changedData=!0);else{let i=!1;n===-1?(n=this._data.length,this._setBit(t),this._changedData=!0):i=!0,this._setInternalPos(n,t,e,i),this._changedLength=!0}}unset(t){this.set(t,void 0)}get(t){this._sortData();let e=this._internalPositionFor(t,!0);if(e!==-1)return this._data[e][1]}push(t){return this.set(this.length,t),this.length}get length(){if(this._sortData(),this._changedLength){let t=this._data[this._data.length-1];this._length=t?t[0]+1:0,this._changedLength=!1}return this._length}forEach(t){let e=0;for(;e<this.length;)t(this.get(e),e,this),e++}map(t){let e=0,n=new Array(this.length);for(;e<this.length;)n[e]=t(this.get(e),e,this),e++;return n}reduce(t,e){let n=0,i=e;for(;n<this.length;){let o=this.get(n);i=t(i,o,n),n++}return i}find(t){let e=0,n,i;for(;e<this.length&&!n;)i=this.get(e),n=t(i),e++;return n?i:void 0}_internalPositionFor(t,e){let n=this._bytePosFor(t,e);if(n>=this._bitArrays.length)return-1;let i=this._bitArrays[n],o=t-n*7;if(!((i&1<<o)>0))return-1;let f=this._bitArrays.slice(0,n).reduce(Fo,0),a=~(4294967295<<o+1),h=Ln(i&a);return f+h-1}_bytePosFor(t,e){let n=Math.floor(t/7),i=n+1;for(;!e&&this._bitArrays.length<i;)this._bitArrays.push(0);return n}_setBit(t){let e=this._bytePosFor(t,!1);this._bitArrays[e]|=1<<t-e*7}_unsetBit(t){let e=this._bytePosFor(t,!1);this._bitArrays[e]&=~(1<<t-e*7)}_setInternalPos(t,e,n,i){let o=this._data,s=[e,n];if(i)this._sortData(),o[t]=s;else{if(o.length)if(o[o.length-1][0]>=e)o.push(s);else if(o[0][0]<=e)o.unshift(s);else{let f=Math.round(o.length/2);this._data=o.slice(0,f).concat(s).concat(o.slice(f))}else this._data.push(s);this._changedData=!0,this._changedLength=!0}}_unsetInternalPos(t){this._data.splice(t,1)}_sortData(){this._changedData&&this._data.sort(Uo),this._changedData=!1}bitField(){let t=[],e=8,n=0,i=0,o,s=this._bitArrays.slice();for(;s.length||n;){n===0&&(o=s.shift(),n=7);let a=Math.min(n,e),h=~(255<<a),u=o&h;i|=u<<8-e,o=o>>>a,n-=a,e-=a,(!e||!n&&!s.length)&&(t.push(i),i=0,e=8)}for(var f=t.length-1;f>0&&t[f]===0;f--)t.pop();return t}compactArray(){return this._sortData(),this._data.map(Mo)}};function Fo(r,t){return r+Ln(t)}function Ln(r){let t=r;return t=t-(t>>1&1431655765),t=(t&858993459)+(t>>2&858993459),(t+(t>>4)&252645135)*16843009>>24}function Uo(r,t){return r[0]-t[0]}function Mo(r){return r[1]}});var Vn=C((Ut,te)=>{(function(r,t){"use strict";var e={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function n(c){if(!Array.isArray(c)&&!ArrayBuffer.isView(c))return!1;for(var l=0;l<c.length;l++)if(!Number.isInteger(c[l])||c[l]<0||c[l]>255)return!1;return!0}function i(c,l){return(c&65535)*l+(((c>>>16)*l&65535)<<16)}function o(c,l){return c<<l|c>>>32-l}function s(c){return c^=c>>>16,c=i(c,2246822507),c^=c>>>13,c=i(c,3266489909),c^=c>>>16,c}function f(c,l){c=[c[0]>>>16,c[0]&65535,c[1]>>>16,c[1]&65535],l=[l[0]>>>16,l[0]&65535,l[1]>>>16,l[1]&65535];var m=[0,0,0,0];return m[3]+=c[3]+l[3],m[2]+=m[3]>>>16,m[3]&=65535,m[2]+=c[2]+l[2],m[1]+=m[2]>>>16,m[2]&=65535,m[1]+=c[1]+l[1],m[0]+=m[1]>>>16,m[1]&=65535,m[0]+=c[0]+l[0],m[0]&=65535,[m[0]<<16|m[1],m[2]<<16|m[3]]}function a(c,l){c=[c[0]>>>16,c[0]&65535,c[1]>>>16,c[1]&65535],l=[l[0]>>>16,l[0]&65535,l[1]>>>16,l[1]&65535];var m=[0,0,0,0];return m[3]+=c[3]*l[3],m[2]+=m[3]>>>16,m[3]&=65535,m[2]+=c[2]*l[3],m[1]+=m[2]>>>16,m[2]&=65535,m[2]+=c[3]*l[2],m[1]+=m[2]>>>16,m[2]&=65535,m[1]+=c[1]*l[3],m[0]+=m[1]>>>16,m[1]&=65535,m[1]+=c[2]*l[2],m[0]+=m[1]>>>16,m[1]&=65535,m[1]+=c[3]*l[1],m[0]+=m[1]>>>16,m[1]&=65535,m[0]+=c[0]*l[3]+c[1]*l[2]+c[2]*l[1]+c[3]*l[0],m[0]&=65535,[m[0]<<16|m[1],m[2]<<16|m[3]]}function h(c,l){return l%=64,l===32?[c[1],c[0]]:l<32?[c[0]<<l|c[1]>>>32-l,c[1]<<l|c[0]>>>32-l]:(l-=32,[c[1]<<l|c[0]>>>32-l,c[0]<<l|c[1]>>>32-l])}function u(c,l){return l%=64,l===0?c:l<32?[c[0]<<l|c[1]>>>32-l,c[1]<<l]:[c[1]<<l-32,0]}function p(c,l){return[c[0]^l[0],c[1]^l[1]]}function D(c){return c=p(c,[0,c[0]>>>1]),c=a(c,[4283543511,3981806797]),c=p(c,[0,c[0]>>>1]),c=a(c,[3301882366,444984403]),c=p(c,[0,c[0]>>>1]),c}e.x86.hash32=function(c,l){if(e.inputValidation&&!n(c))return t;l=l||0;for(var m=c.length%4,S=c.length-m,d=l,y=0,w=3432918353,b=461845907,_=0;_<S;_=_+4)y=c[_]|c[_+1]<<8|c[_+2]<<16|c[_+3]<<24,y=i(y,w),y=o(y,15),y=i(y,b),d^=y,d=o(d,13),d=i(d,5)+3864292196;switch(y=0,m){case 3:y^=c[_+2]<<16;case 2:y^=c[_+1]<<8;case 1:y^=c[_],y=i(y,w),y=o(y,15),y=i(y,b),d^=y}return d^=c.length,d=s(d),d>>>0},e.x86.hash128=function(c,l){if(e.inputValidation&&!n(c))return t;l=l||0;for(var m=c.length%16,S=c.length-m,d=l,y=l,w=l,b=l,_=0,v=0,g=0,E=0,X=597399067,Mt=2869860233,Ht=951274213,Ot=2716044179,B=0;B<S;B=B+16)_=c[B]|c[B+1]<<8|c[B+2]<<16|c[B+3]<<24,v=c[B+4]|c[B+5]<<8|c[B+6]<<16|c[B+7]<<24,g=c[B+8]|c[B+9]<<8|c[B+10]<<16|c[B+11]<<24,E=c[B+12]|c[B+13]<<8|c[B+14]<<16|c[B+15]<<24,_=i(_,X),_=o(_,15),_=i(_,Mt),d^=_,d=o(d,19),d+=y,d=i(d,5)+1444728091,v=i(v,Mt),v=o(v,16),v=i(v,Ht),y^=v,y=o(y,17),y+=w,y=i(y,5)+197830471,g=i(g,Ht),g=o(g,17),g=i(g,Ot),w^=g,w=o(w,15),w+=b,w=i(w,5)+2530024501,E=i(E,Ot),E=o(E,18),E=i(E,X),b^=E,b=o(b,13),b+=d,b=i(b,5)+850148119;switch(_=0,v=0,g=0,E=0,m){case 15:E^=c[B+14]<<16;case 14:E^=c[B+13]<<8;case 13:E^=c[B+12],E=i(E,Ot),E=o(E,18),E=i(E,X),b^=E;case 12:g^=c[B+11]<<24;case 11:g^=c[B+10]<<16;case 10:g^=c[B+9]<<8;case 9:g^=c[B+8],g=i(g,Ht),g=o(g,17),g=i(g,Ot),w^=g;case 8:v^=c[B+7]<<24;case 7:v^=c[B+6]<<16;case 6:v^=c[B+5]<<8;case 5:v^=c[B+4],v=i(v,Mt),v=o(v,16),v=i(v,Ht),y^=v;case 4:_^=c[B+3]<<24;case 3:_^=c[B+2]<<16;case 2:_^=c[B+1]<<8;case 1:_^=c[B],_=i(_,X),_=o(_,15),_=i(_,Mt),d^=_}return d^=c.length,y^=c.length,w^=c.length,b^=c.length,d+=y,d+=w,d+=b,y+=d,w+=d,b+=d,d=s(d),y=s(y),w=s(w),b=s(b),d+=y,d+=w,d+=b,y+=d,w+=d,b+=d,("00000000"+(d>>>0).toString(16)).slice(-8)+("00000000"+(y>>>0).toString(16)).slice(-8)+("00000000"+(w>>>0).toString(16)).slice(-8)+("00000000"+(b>>>0).toString(16)).slice(-8)},e.x64.hash128=function(c,l){if(e.inputValidation&&!n(c))return t;l=l||0;for(var m=c.length%16,S=c.length-m,d=[0,l],y=[0,l],w=[0,0],b=[0,0],_=[2277735313,289559509],v=[1291169091,658871167],g=0;g<S;g=g+16)w=[c[g+4]|c[g+5]<<8|c[g+6]<<16|c[g+7]<<24,c[g]|c[g+1]<<8|c[g+2]<<16|c[g+3]<<24],b=[c[g+12]|c[g+13]<<8|c[g+14]<<16|c[g+15]<<24,c[g+8]|c[g+9]<<8|c[g+10]<<16|c[g+11]<<24],w=a(w,_),w=h(w,31),w=a(w,v),d=p(d,w),d=h(d,27),d=f(d,y),d=f(a(d,[0,5]),[0,1390208809]),b=a(b,v),b=h(b,33),b=a(b,_),y=p(y,b),y=h(y,31),y=f(y,d),y=f(a(y,[0,5]),[0,944331445]);switch(w=[0,0],b=[0,0],m){case 15:b=p(b,u([0,c[g+14]],48));case 14:b=p(b,u([0,c[g+13]],40));case 13:b=p(b,u([0,c[g+12]],32));case 12:b=p(b,u([0,c[g+11]],24));case 11:b=p(b,u([0,c[g+10]],16));case 10:b=p(b,u([0,c[g+9]],8));case 9:b=p(b,[0,c[g+8]]),b=a(b,v),b=h(b,33),b=a(b,_),y=p(y,b);case 8:w=p(w,u([0,c[g+7]],56));case 7:w=p(w,u([0,c[g+6]],48));case 6:w=p(w,u([0,c[g+5]],40));case 5:w=p(w,u([0,c[g+4]],32));case 4:w=p(w,u([0,c[g+3]],24));case 3:w=p(w,u([0,c[g+2]],16));case 2:w=p(w,u([0,c[g+1]],8));case 1:w=p(w,[0,c[g]]),w=a(w,_),w=h(w,31),w=a(w,v),d=p(d,w)}return d=p(d,[0,c.length]),y=p(y,[0,c.length]),d=f(d,y),y=f(y,d),d=D(d),y=D(y),d=f(d,y),y=f(y,d),("00000000"+(d[0]>>>0).toString(16)).slice(-8)+("00000000"+(d[1]>>>0).toString(16)).slice(-8)+("00000000"+(y[0]>>>0).toString(16)).slice(-8)+("00000000"+(y[1]>>>0).toString(16)).slice(-8)},typeof Ut<"u"?(typeof te<"u"&&te.exports&&(Ut=te.exports=e),Ut.murmurHash3=e):typeof define=="function"&&define.amd?define([],function(){return e}):(e._murmurHash3=r.murmurHash3,e.noConflict=function(){return r.murmurHash3=e._murmurHash3,e._murmurHash3=t,e.noConflict=t,e},r.murmurHash3=e)})(Ut)});var Gn=C(($c,qn)=>{qn.exports=Vn()});var Ss={};P(Ss,{importByteStream:()=>ks,importBytes:()=>As,importDirectory:()=>Bs,importFile:()=>nr,importer:()=>rr});function hi(r){return r[Symbol.asyncIterator]!=null}function li(r,t=1){return t=Number(t),hi(r)?async function*(){let e=[];if(t<1&&(t=1),t!==Math.round(t))throw new Error("Batch size must be an integer");for await(let n of r)for(e.push(n);e.length>=t;)yield e.slice(0,t),e=e.slice(t);for(;e.length>0;)yield e.slice(0,t),e=e.slice(t)}():function*(){let e=[];if(t<1&&(t=1),t!==Math.round(t))throw new Error("Batch size must be an integer");for(let n of r)for(e.push(n);e.length>=t;)yield e.slice(0,t),e=e.slice(t);for(;e.length>0;)yield e.slice(0,t),e=e.slice(t)}()}var bt=li;async function*xt(r,t=1){for await(let e of bt(r,t)){let n=e.map(async i=>i().then(o=>({ok:!0,value:o}),o=>({ok:!1,err:o})));for(let i=0;i<n.length;i++){let o=await n[i];if(o.ok)yield o.value;else throw o.err}}}var xe=O(_t(),1);var me=O(ae(),1),Wr=O(Hr(),1),Jr=O(nt(),1),ye=O(pe(),1),Kr=O($r(),1);function vi(){Jr.default._configure(),me.default._configure(Wr.default),ye.default._configure(Kr.default)}vi();var Xr=["uint64","int64","sint64","fixed64","sfixed64"];function Bi(r){for(let t of Xr){if(r[t]==null)continue;let e=r[t];r[t]=function(){return BigInt(e.call(this).toString())}}return r}function ge(r){return Bi(new me.default(r))}function Ai(r){for(let t of Xr){if(r[t]==null)continue;let e=r[t];r[t]=function(n){return e.call(this,n.toString())}}return r}function we(){return Ai(ye.default.create())}function At(r,t){let e=ge(r instanceof Uint8Array?r:r.subarray());return t.decode(e)}function kt(r,t){let e=we();return t.encode(r,e,{lengthDelimited:!1}),e.finish()}var ht;(function(r){r[r.VARINT=0]="VARINT",r[r.BIT64=1]="BIT64",r[r.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",r[r.START_GROUP=3]="START_GROUP",r[r.END_GROUP=4]="END_GROUP",r[r.BIT32=5]="BIT32"})(ht||(ht={}));function $t(r,t,e,n){return{name:r,type:t,encode:e,decode:n}}function be(r){function t(i){if(r[i.toString()]==null)throw new Error("Invalid enum value");return r[i]}let e=function(o,s){let f=t(o);s.int32(f)},n=function(o){let s=o.int32();return t(s)};return $t("enum",ht.VARINT,e,n)}function St(r,t){return $t("message",ht.LENGTH_DELIMITED,r,t)}var q;(function(r){let t;(function(i){i.Raw="Raw",i.Directory="Directory",i.File="File",i.Metadata="Metadata",i.Symlink="Symlink",i.HAMTShard="HAMTShard"})(t=r.DataType||(r.DataType={}));let e;(function(i){i[i.Raw=0]="Raw",i[i.Directory=1]="Directory",i[i.File=2]="File",i[i.Metadata=3]="Metadata",i[i.Symlink=4]="Symlink",i[i.HAMTShard=5]="HAMTShard"})(e||(e={})),function(i){i.codec=()=>be(e)}(t=r.DataType||(r.DataType={}));let n;r.codec=()=>(n==null&&(n=St((i,o,s={})=>{if(s.lengthDelimited!==!1&&o.fork(),i.Type!=null&&(o.uint32(8),r.DataType.codec().encode(i.Type,o)),i.Data!=null&&(o.uint32(18),o.bytes(i.Data)),i.filesize!=null&&(o.uint32(24),o.uint64(i.filesize)),i.blocksizes!=null)for(let f of i.blocksizes)o.uint32(32),o.uint64(f);i.hashType!=null&&(o.uint32(40),o.uint64(i.hashType)),i.fanout!=null&&(o.uint32(48),o.uint64(i.fanout)),i.mode!=null&&(o.uint32(56),o.uint32(i.mode)),i.mtime!=null&&(o.uint32(66),Wt.codec().encode(i.mtime,o)),s.lengthDelimited!==!1&&o.ldelim()},(i,o)=>{let s={blocksizes:[]},f=o==null?i.len:i.pos+o;for(;i.pos<f;){let a=i.uint32();switch(a>>>3){case 1:s.Type=r.DataType.codec().decode(i);break;case 2:s.Data=i.bytes();break;case 3:s.filesize=i.uint64();break;case 4:s.blocksizes.push(i.uint64());break;case 5:s.hashType=i.uint64();break;case 6:s.fanout=i.uint64();break;case 7:s.mode=i.uint32();break;case 8:s.mtime=Wt.codec().decode(i,i.uint32());break;default:i.skipType(a&7);break}}return s})),n),r.encode=i=>kt(i,r.codec()),r.decode=i=>At(i,r.codec())})(q||(q={}));var Wt;(function(r){let t;r.codec=()=>(t==null&&(t=St((e,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),e.Seconds!=null&&(n.uint32(8),n.int64(e.Seconds)),e.FractionalNanoseconds!=null&&(n.uint32(21),n.fixed32(e.FractionalNanoseconds)),i.lengthDelimited!==!1&&n.ldelim()},(e,n)=>{let i={},o=n==null?e.len:e.pos+n;for(;e.pos<o;){let s=e.uint32();switch(s>>>3){case 1:i.Seconds=e.int64();break;case 2:i.FractionalNanoseconds=e.fixed32();break;default:e.skipType(s&7);break}}return i})),t),r.encode=e=>kt(e,r.codec()),r.decode=e=>At(e,r.codec())})(Wt||(Wt={}));var Qr;(function(r){let t;r.codec=()=>(t==null&&(t=St((e,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),e.MimeType!=null&&(n.uint32(10),n.string(e.MimeType)),i.lengthDelimited!==!1&&n.ldelim()},(e,n)=>{let i={},o=n==null?e.len:e.pos+n;for(;e.pos<o;){let s=e.uint32();switch(s>>>3){case 1:i.MimeType=e.string();break;default:e.skipType(s&7);break}}return i})),t),r.encode=e=>kt(e,r.codec()),r.decode=e=>At(e,r.codec())})(Qr||(Qr={}));var Zr={Raw:"raw",Directory:"directory",File:"file",Metadata:"metadata",Symlink:"symlink",HAMTShard:"hamt-sharded-directory"},ki=["directory","hamt-sharded-directory"],Yr=parseInt("0644",8),tn=parseInt("0755",8),z=class{static unmarshal(t){let e=q.decode(t),n=new z({type:Zr[e.Type!=null?e.Type.toString():"File"],data:e.Data,blockSizes:e.blocksizes,mode:e.mode,mtime:e.mtime!=null?{secs:e.mtime.Seconds??0n,nsecs:e.mtime.FractionalNanoseconds}:void 0});return n._originalMode=e.mode??0,n}constructor(t={type:"file"}){let{type:e,data:n,blockSizes:i,hashType:o,fanout:s,mtime:f,mode:a}=t;if(e!=null&&!Object.values(Zr).includes(e))throw(0,xe.default)(new Error("Type: "+e+" is not valid"),"ERR_INVALID_TYPE");this.type=e??"file",this.data=n,this.hashType=o,this.fanout=s,this.blockSizes=i??[],this._originalMode=0,this.mode=a,this.mtime=f}set mode(t){t==null?this._mode=this.isDirectory()?tn:Yr:this._mode=t&4095}get mode(){return this._mode}isDirectory(){return ki.includes(this.type)}addBlockSize(t){this.blockSizes.push(t)}removeBlockSize(t){this.blockSizes.splice(t,1)}fileSize(){if(this.isDirectory())return 0n;let t=0n;return this.blockSizes.forEach(e=>{t+=e}),this.data!=null&&(t+=BigInt(this.data.length)),t}marshal(){let t;switch(this.type){case"raw":t=q.DataType.Raw;break;case"directory":t=q.DataType.Directory;break;case"file":t=q.DataType.File;break;case"metadata":t=q.DataType.Metadata;break;case"symlink":t=q.DataType.Symlink;break;case"hamt-sharded-directory":t=q.DataType.HAMTShard;break;default:throw(0,xe.default)(new Error(`Type: ${t} is not valid`),"ERR_INVALID_TYPE")}let e=this.data;(this.data==null||this.data.length===0)&&(e=void 0);let n;this.mode!=null&&(n=this._originalMode&4294963200|(this.mode??0),n===Yr&&!this.isDirectory()&&(n=void 0),n===tn&&this.isDirectory()&&(n=void 0));let i;return this.mtime!=null&&(i={Seconds:this.mtime.secs,FractionalNanoseconds:this.mtime.nsecs}),q.encode({Type:t,Data:e,filesize:this.isDirectory()?void 0:this.fileSize(),blocksizes:this.blockSizes,hashType:this.hashType,fanout:this.fanout,mode:n,mtime:i})}};var Si=nn,en=128,Di=127,Ei=~Di,Li=Math.pow(2,31);function nn(r,t,e){t=t||[],e=e||0;for(var n=e;r>=Li;)t[e++]=r&255|en,r/=128;for(;r&Ei;)t[e++]=r&255|en,r>>>=7;return t[e]=r|0,nn.bytes=e-n+1,t}var Ti=_e,Ni=128,rn=127;function _e(r,n){var e=0,n=n||0,i=0,o=n,s,f=r.length;do{if(o>=f)throw _e.bytes=0,new RangeError("Could not decode varint");s=r[o++],e+=i<28?(s&rn)<<i:(s&rn)*Math.pow(2,i),i+=7}while(s>=Ni);return _e.bytes=o-n,e}var Ci=Math.pow(2,7),Pi=Math.pow(2,14),zi=Math.pow(2,21),Ii=Math.pow(2,28),Fi=Math.pow(2,35),Ui=Math.pow(2,42),Mi=Math.pow(2,49),Hi=Math.pow(2,56),Oi=Math.pow(2,63),Ri=function(r){return r<Ci?1:r<Pi?2:r<zi?3:r<Ii?4:r<Fi?5:r<Ui?6:r<Mi?7:r<Hi?8:r<Oi?9:10},Vi={encode:Si,decode:Ti,encodingLength:Ri},qi=Vi,Dt=qi;var Et=(r,t=0)=>[Dt.decode(r,t),Dt.decode.bytes],lt=(r,t,e=0)=>(Dt.encode(r,t,e),t),dt=r=>Dt.encodingLength(r);var pt={};P(pt,{coerce:()=>H,empty:()=>on,equals:()=>ve,fromHex:()=>ji,fromString:()=>Be,isBinary:()=>$i,toHex:()=>Gi,toString:()=>Ae});var on=new Uint8Array(0),Gi=r=>r.reduce((t,e)=>t+e.toString(16).padStart(2,"0"),""),ji=r=>{let t=r.match(/../g);return t?new Uint8Array(t.map(e=>parseInt(e,16))):on},ve=(r,t)=>{if(r===t)return!0;if(r.byteLength!==t.byteLength)return!1;for(let e=0;e<r.byteLength;e++)if(r[e]!==t[e])return!1;return!0},H=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")},$i=r=>r instanceof ArrayBuffer||ArrayBuffer.isView(r),Be=r=>new TextEncoder().encode(r),Ae=r=>new TextDecoder().decode(r);var ot=(r,t)=>{let e=t.byteLength,n=dt(r),i=n+dt(e),o=new Uint8Array(i+e);return lt(r,o,0),lt(e,o,n),o.set(t,i),new mt(r,e,t,o)},sn=r=>{let t=H(r),[e,n]=Et(t),[i,o]=Et(t.subarray(n)),s=t.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new mt(e,i,s,t)},an=(r,t)=>{if(r===t)return!0;{let e=t;return r.code===e.code&&r.size===e.size&&e.bytes instanceof Uint8Array&&ve(r.bytes,e.bytes)}},mt=class{constructor(t,e,n,i){this.code=t,this.size=e,this.digest=n,this.bytes=i}};var Le={};P(Le,{base58btc:()=>W,base58flickr:()=>Zi});function Wi(r,t){if(r.length>=255)throw new TypeError("Alphabet too long");for(var e=new Uint8Array(256),n=0;n<e.length;n++)e[n]=255;for(var i=0;i<r.length;i++){var o=r.charAt(i),s=o.charCodeAt(0);if(e[s]!==255)throw new TypeError(o+" is ambiguous");e[s]=i}var f=r.length,a=r.charAt(0),h=Math.log(f)/Math.log(256),u=Math.log(256)/Math.log(f);function p(l){if(l instanceof Uint8Array||(ArrayBuffer.isView(l)?l=new Uint8Array(l.buffer,l.byteOffset,l.byteLength):Array.isArray(l)&&(l=Uint8Array.from(l))),!(l instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(l.length===0)return"";for(var m=0,S=0,d=0,y=l.length;d!==y&&l[d]===0;)d++,m++;for(var w=(y-d)*u+1>>>0,b=new Uint8Array(w);d!==y;){for(var _=l[d],v=0,g=w-1;(_!==0||v<S)&&g!==-1;g--,v++)_+=256*b[g]>>>0,b[g]=_%f>>>0,_=_/f>>>0;if(_!==0)throw new Error("Non-zero carry");S=v,d++}for(var E=w-S;E!==w&&b[E]===0;)E++;for(var X=a.repeat(m);E<w;++E)X+=r.charAt(b[E]);return X}function D(l){if(typeof l!="string")throw new TypeError("Expected String");if(l.length===0)return new Uint8Array;var m=0;if(l[m]!==" "){for(var S=0,d=0;l[m]===a;)S++,m++;for(var y=(l.length-m)*h+1>>>0,w=new Uint8Array(y);l[m];){var b=e[l.charCodeAt(m)];if(b===255)return;for(var _=0,v=y-1;(b!==0||_<d)&&v!==-1;v--,_++)b+=f*w[v]>>>0,w[v]=b%256>>>0,b=b/256>>>0;if(b!==0)throw new Error("Non-zero carry");d=_,m++}if(l[m]!==" "){for(var g=y-d;g!==y&&w[g]===0;)g++;for(var E=new Uint8Array(S+(y-g)),X=S;g!==y;)E[X++]=w[g++];return E}}}function c(l){var m=D(l);if(m)return m;throw new Error(`Non-${t} character`)}return{encode:p,decodeUnsafe:D,decode:c}}var Ji=Wi,Ki=Ji,cn=Ki;var ke=class{constructor(t,e,n){this.name=t,this.prefix=e,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},Se=class{constructor(t,e,n){if(this.name=t,this.prefix=e,e.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=e.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return fn(this,t)}},De=class{constructor(t){this.decoders=t}or(t){return fn(this,t)}decode(t){let e=t[0],n=this.decoders[e];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},fn=(r,t)=>new De({...r.decoders||{[r.prefix]:r},...t.decoders||{[t.prefix]:t}}),Ee=class{constructor(t,e,n,i){this.name=t,this.prefix=e,this.baseEncode=n,this.baseDecode=i,this.encoder=new ke(t,e,n),this.decoder=new Se(t,e,i)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}},yt=({name:r,prefix:t,encode:e,decode:n})=>new Ee(r,t,e,n),et=({prefix:r,name:t,alphabet:e})=>{let{encode:n,decode:i}=cn(e,t);return yt({prefix:r,name:t,encode:n,decode:o=>H(i(o))})},Xi=(r,t,e,n)=>{let i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let o=r.length;for(;r[o-1]==="=";)--o;let s=new Uint8Array(o*e/8|0),f=0,a=0,h=0;for(let u=0;u<o;++u){let p=i[r[u]];if(p===void 0)throw new SyntaxError(`Non-${n} character`);a=a<<e|p,f+=e,f>=8&&(f-=8,s[h++]=255&a>>f)}if(f>=e||255&a<<8-f)throw new SyntaxError("Unexpected end of data");return s},Qi=(r,t,e)=>{let n=t[t.length-1]==="=",i=(1<<e)-1,o="",s=0,f=0;for(let a=0;a<r.length;++a)for(f=f<<8|r[a],s+=8;s>e;)s-=e,o+=t[i&f>>s];if(s&&(o+=t[i&f<<e-s]),n)for(;o.length*e&7;)o+="=";return o},L=({name:r,prefix:t,bitsPerChar:e,alphabet:n})=>yt({prefix:t,name:r,encode(i){return Qi(i,n,e)},decode(i){return Xi(i,n,e,r)}});var W=et({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Zi=et({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Te={};P(Te,{base32:()=>gt,base32hex:()=>ro,base32hexpad:()=>io,base32hexpadupper:()=>oo,base32hexupper:()=>no,base32pad:()=>to,base32padupper:()=>eo,base32upper:()=>Yi,base32z:()=>so});var gt=L({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Yi=L({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),to=L({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),eo=L({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),ro=L({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),no=L({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),io=L({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),oo=L({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),so=L({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var un=(r,t)=>{let{bytes:e,version:n}=r;switch(n){case 0:return co(e,Ne(r),t||W.encoder);default:return fo(e,Ne(r),t||gt.encoder)}};var hn=new WeakMap,Ne=r=>{let t=hn.get(r);if(t==null){let e=new Map;return hn.set(r,e),e}return t},k=class{constructor(t,e,n,i){this.code=e,this.version=t,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:t,multihash:e}=this;if(t!==Tt)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(e.code!==uo)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return k.createV0(e)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:t,digest:e}=this.multihash,n=ot(t,e);return k.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return k.equals(this,t)}static equals(t,e){let n=e;return n&&t.code===n.code&&t.version===n.version&&an(t.multihash,n.multihash)}toString(t){return un(this,t)}toJSON(){return{"/":un(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;let e=t;if(e instanceof k)return e;if(e["/"]!=null&&e["/"]===e.bytes||e.asCID===e){let{version:n,code:i,multihash:o,bytes:s}=e;return new k(n,i,o,s||ln(n,i,o.bytes))}else if(e[ho]===!0){let{version:n,multihash:i,code:o}=e,s=sn(i);return k.create(n,o,s)}else return null}static create(t,e,n){if(typeof e!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(e!==Tt)throw new Error(`Version 0 CID must use dag-pb (code: ${Tt}) block encoding`);return new k(t,e,n,n.bytes)}case 1:{let i=ln(t,e,n.bytes);return new k(t,e,n,i)}default:throw new Error("Invalid version")}}static createV0(t){return k.create(0,Tt,t)}static createV1(t,e){return k.create(1,t,e)}static decode(t){let[e,n]=k.decodeFirst(t);if(n.length)throw new Error("Incorrect length");return e}static decodeFirst(t){let e=k.inspectBytes(t),n=e.size-e.multihashSize,i=H(t.subarray(n,n+e.multihashSize));if(i.byteLength!==e.multihashSize)throw new Error("Incorrect length");let o=i.subarray(e.multihashSize-e.digestSize),s=new mt(e.multihashCode,e.digestSize,o,i);return[e.version===0?k.createV0(s):k.createV1(e.codec,s),t.subarray(e.size)]}static inspectBytes(t){let e=0,n=()=>{let[p,D]=Et(t.subarray(e));return e+=D,p},i=n(),o=Tt;if(i===18?(i=0,e=0):o=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let s=e,f=n(),a=n(),h=e+a,u=h-s;return{version:i,codec:o,multihashCode:f,digestSize:a,multihashSize:u,size:h}}static parse(t,e){let[n,i]=ao(t,e),o=k.decode(i);if(o.version===0&&t[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return Ne(o).set(n,t),o}},ao=(r,t)=>{switch(r[0]){case"Q":{let e=t||W;return[W.prefix,e.decode(`${W.prefix}${r}`)]}case W.prefix:{let e=t||W;return[W.prefix,e.decode(r)]}case gt.prefix:{let e=t||gt;return[gt.prefix,e.decode(r)]}default:{if(t==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],t.decode(r)]}}},co=(r,t,e)=>{let{prefix:n}=e;if(n!==W.prefix)throw Error(`Cannot string encode V0 in ${e.name} encoding`);let i=t.get(n);if(i==null){let o=e.encode(r).slice(1);return t.set(n,o),o}else return i},fo=(r,t,e)=>{let{prefix:n}=e,i=t.get(n);if(i==null){let o=e.encode(r);return t.set(n,o),o}else return i},Tt=112,uo=18,ln=(r,t,e)=>{let n=dt(r),i=n+dt(t),o=new Uint8Array(i+e.byteLength);return lt(r,o,0),lt(t,o,n),o.set(e,i),o},ho=Symbol.for("@ipld/js-cid/CID");var Ct={};P(Ct,{code:()=>Ao,createLink:()=>vn,createNode:()=>_n,decode:()=>ko,encode:()=>U,name:()=>Bo,prepare:()=>F,validate:()=>ze});var lo=new TextDecoder;function Ce(r,t){let e=0;for(let n=0;;n+=7){if(n>=64)throw new Error("protobuf: varint overflow");if(t>=r.length)throw new Error("protobuf: unexpected end of data");let i=r[t++];if(e+=n<28?(i&127)<<n:(i&127)*2**n,i<128)break}return[e,t]}function Kt(r,t){let e;[e,t]=Ce(r,t);let n=t+e;if(e<0||n<0)throw new Error("protobuf: invalid length");if(n>r.length)throw new Error("protobuf: unexpected end of data");return[r.subarray(t,n),n]}function dn(r,t){let e;return[e,t]=Ce(r,t),[e&7,e>>3,t]}function po(r){let t={},e=r.length,n=0;for(;n<e;){let i,o;if([i,o,n]=dn(r,n),o===1){if(t.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(i!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Hash`);if(t.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(t.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[t.Hash,n]=Kt(r,n)}else if(o===2){if(t.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(i!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Name`);if(t.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let s;[s,n]=Kt(r,n),t.Name=lo.decode(s)}else if(o===3){if(t.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(i!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Tsize`);[t.Tsize,n]=Ce(r,n)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${o}`)}if(n>e)throw new Error("protobuf: (PBLink) unexpected end of data");return t}function pn(r){let t=r.length,e=0,n,i=!1,o;for(;e<t;){let f,a;if([f,a,e]=dn(r,e),f!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${f}`);if(a===1){if(o)throw new Error("protobuf: (PBNode) duplicate Data section");[o,e]=Kt(r,e),n&&(i=!0)}else if(a===2){if(i)throw new Error("protobuf: (PBNode) duplicate Links section");n||(n=[]);let h;[h,e]=Kt(r,e),n.push(po(h))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${a}`)}if(e>t)throw new Error("protobuf: (PBNode) unexpected end of data");let s={};return o&&(s.Data=o),s.Links=n||[],s}var yn=new TextEncoder,mn=2**32,mo=2**31;function yo(r,t){let e=t.length;if(typeof r.Tsize=="number"){if(r.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(r.Tsize))throw new Error("Tsize too large for encoding");e=Nt(t,e,r.Tsize)-1,t[e]=24}if(typeof r.Name=="string"){let n=yn.encode(r.Name);e-=n.length,t.set(n,e),e=Nt(t,e,n.length)-1,t[e]=18}return r.Hash&&(e-=r.Hash.length,t.set(r.Hash,e),e=Nt(t,e,r.Hash.length)-1,t[e]=10),t.length-e}function gn(r){let t=wo(r),e=new Uint8Array(t),n=t;if(r.Data&&(n-=r.Data.length,e.set(r.Data,n),n=Nt(e,n,r.Data.length)-1,e[n]=10),r.Links)for(let i=r.Links.length-1;i>=0;i--){let o=yo(r.Links[i],e.subarray(0,n));n-=o,n=Nt(e,n,o)-1,e[n]=18}return e}function go(r){let t=0;if(r.Hash){let e=r.Hash.length;t+=1+e+wt(e)}if(typeof r.Name=="string"){let e=yn.encode(r.Name).length;t+=1+e+wt(e)}return typeof r.Tsize=="number"&&(t+=1+wt(r.Tsize)),t}function wo(r){let t=0;if(r.Data){let e=r.Data.length;t+=1+e+wt(e)}if(r.Links)for(let e of r.Links){let n=go(e);t+=1+n+wt(n)}return t}function Nt(r,t,e){t-=wt(e);let n=t;for(;e>=mo;)r[t++]=e&127|128,e/=128;for(;e>=128;)r[t++]=e&127|128,e>>>=7;return r[t]=e,n}function wt(r){return r%2===0&&r++,Math.floor((bo(r)+6)/7)}function bo(r){let t=0;return r>=mn&&(r=Math.floor(r/mn),t=32),r>=1<<16&&(r>>>=16,t+=16),r>=1<<8&&(r>>>=8,t+=8),t+xo[r]}var xo=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8];var _o=["Data","Links"],vo=["Hash","Name","Tsize"],Pe=new TextEncoder;function bn(r,t){if(r===t)return 0;let e=r.Name?Pe.encode(r.Name):[],n=t.Name?Pe.encode(t.Name):[],i=e.length,o=n.length;for(let s=0,f=Math.min(i,o);s<f;++s)if(e[s]!==n[s]){i=e[s],o=n[s];break}return i<o?-1:o<i?1:0}function wn(r,t){return!Object.keys(r).some(e=>!t.includes(e))}function xn(r){if(typeof r.asCID=="object"){let e=k.asCID(r);if(!e)throw new TypeError("Invalid DAG-PB form");return{Hash:e}}if(typeof r!="object"||Array.isArray(r))throw new TypeError("Invalid DAG-PB form");let t={};if(r.Hash){let e=k.asCID(r.Hash);try{e||(typeof r.Hash=="string"?e=k.parse(r.Hash):r.Hash instanceof Uint8Array&&(e=k.decode(r.Hash)))}catch(n){throw new TypeError(`Invalid DAG-PB form: ${n.message}`)}e&&(t.Hash=e)}if(!t.Hash)throw new TypeError("Invalid DAG-PB form");return typeof r.Name=="string"&&(t.Name=r.Name),typeof r.Tsize=="number"&&(t.Tsize=r.Tsize),t}function F(r){if((r instanceof Uint8Array||typeof r=="string")&&(r={Data:r}),typeof r!="object"||Array.isArray(r))throw new TypeError("Invalid DAG-PB form");let t={};if(r.Data!==void 0)if(typeof r.Data=="string")t.Data=Pe.encode(r.Data);else if(r.Data instanceof Uint8Array)t.Data=r.Data;else throw new TypeError("Invalid DAG-PB form");if(r.Links!==void 0)if(Array.isArray(r.Links))t.Links=r.Links.map(xn),t.Links.sort(bn);else throw new TypeError("Invalid DAG-PB form");else t.Links=[];return t}function ze(r){if(!r||typeof r!="object"||Array.isArray(r)||r instanceof Uint8Array||r["/"]&&r["/"]===r.bytes)throw new TypeError("Invalid DAG-PB form");if(!wn(r,_o))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(r.Data!==void 0&&!(r.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be bytes)");if(!Array.isArray(r.Links))throw new TypeError("Invalid DAG-PB form (Links must be a list)");for(let t=0;t<r.Links.length;t++){let e=r.Links[t];if(!e||typeof e!="object"||Array.isArray(e)||e instanceof Uint8Array||e["/"]&&e["/"]===e.bytes)throw new TypeError("Invalid DAG-PB form (bad link)");if(!wn(e,vo))throw new TypeError("Invalid DAG-PB form (extraneous properties on link)");if(e.Hash===void 0)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(e.Hash==null||!e.Hash["/"]||e.Hash["/"]!==e.Hash.bytes)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(e.Name!==void 0&&typeof e.Name!="string")throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(e.Tsize!==void 0){if(typeof e.Tsize!="number"||e.Tsize%1!==0)throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(e.Tsize<0)throw new TypeError("Invalid DAG-PB form (link Tsize cannot be negative)")}if(t>0&&bn(e,r.Links[t-1])===-1)throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function _n(r,t=[]){return F({Data:r,Links:t})}function vn(r,t,e){return xn({Hash:e,Name:r,Tsize:t})}var Bo="dag-pb",Ao=112;function U(r){ze(r);let t={};return r.Links&&(t.Links=r.Links.map(e=>{let n={};return e.Hash&&(n.Hash=e.Hash.bytes),e.Name!==void 0&&(n.Name=e.Name),e.Tsize!==void 0&&(n.Tsize=e.Tsize),n})),r.Data&&(t.Data=r.Data),gn(t)}function ko(r){let t=pn(r),e={};return t.Data&&(e.Data=t.Data),t.Links&&(e.Links=t.Links.map(n=>{let i={};try{i.Hash=k.decode(n.Hash)}catch{}if(!i.Hash)throw new Error("Invalid Hash field found in link, expected CID");return n.Name!==void 0&&(i.Name=n.Name),n.Tsize!==void 0&&(i.Tsize=n.Tsize),i})),e}var Ue={};P(Ue,{sha256:()=>Fe,sha512:()=>So});var st=({name:r,code:t,encode:e})=>new Ie(r,t,e),Ie=class{constructor(t,e,n){this.name=t,this.code=e,this.encode=n}digest(t){if(t instanceof Uint8Array){let e=this.encode(t);return e instanceof Uint8Array?ot(this.code,e):e.then(n=>ot(this.code,n))}else throw Error("Unknown type, must be binary type")}};var An=r=>async t=>new Uint8Array(await crypto.subtle.digest(r,t)),Fe=st({name:"sha2-256",code:18,encode:An("SHA-256")}),So=st({name:"sha2-512",code:19,encode:An("SHA-512")});var G=async(r,t,e)=>{e.codec==null&&(e.codec=Ct);let n=await Fe.digest(r),i=k.create(e.cidVersion,e.codec.code,n);return await t.put(i,r,e),i};var kn=async(r,t,e)=>{let n=new z({type:"directory",mtime:r.mtime,mode:r.mode}),i=U(F({Data:n.marshal()})),o=await G(i,t,e),s=r.path;return{cid:o,path:s,unixfs:n,size:BigInt(i.length),originalPath:r.originalPath,block:i}};var Pt={};P(Pt,{code:()=>Xt,decode:()=>Lo,encode:()=>Eo,name:()=>Do});var Do="raw",Xt=85,Eo=r=>H(r),Lo=r=>H(r);var Q=class extends Event{constructor(t,e){super(t),this.detail=e}};async function*To(r,t,e){let n=-1,i;for await(let o of xt(e.bufferImporter(r,t),e.blockWriteConcurrency)){if(n++,n===0){i={...o,single:!0};continue}else n===1&&i!=null&&(yield{...i,block:void 0,single:void 0},i=void 0);yield{...o,block:void 0}}i!=null&&(yield i)}function Sn(r){return r.single===!0}var No=(r,t,e)=>async function(i){if(i.length===1&&Sn(i[0])&&e.reduceSingleLeafToSelf){let u=i[0],p=u.block;return Sn(u)&&(r.mtime!==void 0||r.mode!==void 0)&&(u.unixfs=new z({type:"file",mtime:r.mtime,mode:r.mode,data:u.block}),p={Data:u.unixfs.marshal(),Links:[]},u.block=U(F(p)),u.cid=await G(u.block,t,{...e,cidVersion:e.cidVersion}),u.size=BigInt(u.block.length)),e.onProgress?.(new Q("unixfs:importer:progress:file:layout",{cid:u.cid,path:u.originalPath})),{cid:u.cid,path:r.path,unixfs:u.unixfs,size:u.size,originalPath:u.originalPath}}let o=new z({type:"file",mtime:r.mtime,mode:r.mode}),s=i.filter(u=>u.cid.code===Xt&&u.size>0||u.unixfs!=null&&u.unixfs.data==null&&u.unixfs.fileSize()>0n?!0:!!u.unixfs?.data?.length).map(u=>u.cid.code===Xt?(o.addBlockSize(u.size),{Name:"",Tsize:Number(u.size),Hash:u.cid}):(u.unixfs==null||u.unixfs.data==null?o.addBlockSize(u.unixfs?.fileSize()??0n):o.addBlockSize(BigInt(u.unixfs.data.length)),{Name:"",Tsize:Number(u.size),Hash:u.cid})),f={Data:o.marshal(),Links:s},a=U(F(f)),h=await G(a,t,e);return e.onProgress?.(new Q("unixfs:importer:progress:file:layout",{cid:h,path:r.originalPath})),{cid:h,path:r.path,unixfs:o,size:BigInt(a.length+f.Links.reduce((u,p)=>u+(p.Tsize??0),0)),originalPath:r.originalPath,block:a}},Dn=async(r,t,e)=>await e.layout(To(r,t,e),No(r,t,e));var Me=O(_t(),1);function Co(r){return Symbol.iterator in r}function Po(r){return Symbol.asyncIterator in r}function zo(r){try{if(r instanceof Uint8Array)return async function*(){yield r}();if(Co(r))return async function*(){yield*r}();if(Po(r))return r}catch{throw(0,Me.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}throw(0,Me.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}function En(r){return async function*(e,n){for await(let i of e){let o;if(i.path!=null&&(o=i.path,i.path=i.path.split("/").filter(s=>s!=null&&s!==".").join("/")),Io(i)){let s={path:i.path,mtime:i.mtime,mode:i.mode,content:async function*(){let f=0n;for await(let a of r.chunker(r.chunkValidator(zo(i.content)))){let h=BigInt(a.byteLength);f+=h,r.onProgress?.(new Q("unixfs:importer:progress:file:read",{bytesRead:f,chunkSize:h,path:i.path})),yield a}}(),originalPath:o};yield async()=>await Dn(s,n,r)}else if(i.path!=null){let s={path:i.path,mtime:i.mtime,mode:i.mode,originalPath:o};yield async()=>await kn(s,n,r)}else throw new Error("Import candidate must have content or path or both")}}}function Io(r){return r.content!=null}var J=class{constructor(t,e){this.options=e??{},this.root=t.root,this.dir=t.dir,this.path=t.path,this.dirty=t.dirty,this.flat=t.flat,this.parent=t.parent,this.parentKey=t.parentKey,this.unixfs=t.unixfs,this.mode=t.mode,this.mtime=t.mtime}},zt=k.parse("QmUNLLsPACCz1vLxQVkXqqLX5R1X345qqfHbsf67hvA3Nn"),It=k.parse("zdj7WbTaiJT1fgatdet9Ei9iDB5hdCxkbVyhyh8YTUnXMiwYi");var at=class extends J{constructor(t,e){super(t,e),this._children=new Map}async put(t,e){this.cid=void 0,this.size=void 0,this.nodeSize=void 0,this._children.set(t,e)}async get(t){return await Promise.resolve(this._children.get(t))}childCount(){return this._children.size}directChildrenCount(){return this.childCount()}onlyChild(){return this._children.values().next().value}async*eachChildSeries(){for(let[t,e]of this._children.entries())yield{key:t,child:e}}estimateNodeSize(){if(this.nodeSize!==void 0)return this.nodeSize;this.nodeSize=0;for(let[t,e]of this._children.entries())e.size!=null&&e.cid!=null&&(this.nodeSize+=t.length+(this.options.cidVersion===1?It.bytes.byteLength:zt.bytes.byteLength));return this.nodeSize}async*flush(t){let e=[];for(let[a,h]of this._children.entries()){let u=h;if(h instanceof J)for await(let p of h.flush(t))u=p,yield p;u.size!=null&&u.cid!=null&&e.push({Name:a,Tsize:Number(u.size),Hash:u.cid})}let n=new z({type:"directory",mtime:this.mtime,mode:this.mode}),i={Data:n.marshal(),Links:e},o=U(F(i)),s=await G(o,t,this.options),f=o.length+i.Links.reduce((a,h)=>a+(h.Tsize==null?0:h.Tsize),0);this.cid=s,this.size=f,yield{cid:s,unixfs:n,path:this.path,size:BigInt(f)}}};var Mn=O(Nn(),1);var He={};P(He,{identity:()=>Ho});var Ho=yt({prefix:"\0",name:"identity",encode:r=>Ae(r),decode:r=>Be(r)});var Oe={};P(Oe,{base2:()=>Oo});var Oo=L({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Re={};P(Re,{base8:()=>Ro});var Ro=L({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Ve={};P(Ve,{base10:()=>Vo});var Vo=et({prefix:"9",name:"base10",alphabet:"0123456789"});var qe={};P(qe,{base16:()=>qo,base16upper:()=>Go});var qo=L({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Go=L({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Ge={};P(Ge,{base36:()=>jo,base36upper:()=>$o});var jo=et({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),$o=et({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var je={};P(je,{base64:()=>Wo,base64pad:()=>Jo,base64url:()=>Ko,base64urlpad:()=>Xo});var Wo=L({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Jo=L({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Ko=L({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Xo=L({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var $e={};P($e,{base256emoji:()=>es});var Cn=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Qo=Cn.reduce((r,t,e)=>(r[e]=t,r),[]),Zo=Cn.reduce((r,t,e)=>(r[t.codePointAt(0)]=e,r),[]);function Yo(r){return r.reduce((t,e)=>(t+=Qo[e],t),"")}function ts(r){let t=[];for(let e of r){let n=Zo[e.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${e}`);t.push(n)}return new Uint8Array(t)}var es=yt({prefix:"\u{1F680}",name:"base256emoji",encode:Yo,decode:ts});var We={};P(We,{identity:()=>is});var Pn=0,rs="identity",zn=H,ns=r=>ot(Pn,zn(r)),is={code:Pn,name:rs,encode:zn,digest:ns};var gc=new TextEncoder,wc=new TextDecoder;var Je={...He,...Oe,...Re,...Ve,...qe,...Te,...Ge,...Le,...je,...$e},Bc={...Ue,...We};function ct(r){return globalThis.Buffer!=null?new Uint8Array(r.buffer,r.byteOffset,r.byteLength):r}function Z(r=0){return globalThis.Buffer?.alloc!=null?ct(globalThis.Buffer.alloc(r)):new Uint8Array(r)}function ft(r=0){return globalThis.Buffer?.allocUnsafe!=null?ct(globalThis.Buffer.allocUnsafe(r)):new Uint8Array(r)}function Fn(r,t,e,n){return{name:r,prefix:t,encoder:{name:r,prefix:t,encode:e},decoder:{decode:n}}}var In=Fn("utf8","u",r=>"u"+new TextDecoder("utf8").decode(r),r=>new TextEncoder().encode(r.substring(1))),Ke=Fn("ascii","a",r=>{let t="a";for(let e=0;e<r.length;e++)t+=String.fromCharCode(r[e]);return t},r=>{r=r.substring(1);let t=ft(r.length);for(let e=0;e<r.length;e++)t[e]=r.charCodeAt(e);return t}),ss={utf8:In,"utf-8":In,hex:Je.base16,latin1:Ke,ascii:Ke,binary:Ke,...Je},Un=ss;function Qt(r,t="utf8"){let e=Un[t];if(e==null)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?ct(globalThis.Buffer.from(r,"utf-8")):e.decoder.decode(`${e.prefix}${r}`)}var I=class{constructor(t,e,n=0){this._options=t,this._popCount=0,this._parent=e,this._posAtParent=n,this._children=new Mn.default,this.key=null}async put(t,e){let n=await this._findNewBucketAndPos(t);await n.bucket._putAt(n,t,e)}async get(t){let e=await this._findChild(t);if(e!=null)return e.value}async del(t){let e=await this._findPlace(t),n=e.bucket._at(e.pos);n!=null&&n.key===t&&e.bucket._delAt(e.pos)}leafCount(){return this._children.compactArray().reduce((e,n)=>n instanceof I?e+n.leafCount():e+1,0)}childrenCount(){return this._children.length}onlyChild(){return this._children.get(0)}*eachLeafSeries(){let t=this._children.compactArray();for(let e of t)e instanceof I?yield*e.eachLeafSeries():yield e}serialize(t,e){let n=[];return e(this._children.reduce((i,o,s)=>(o!=null&&(o instanceof I?i.push(o.serialize(t,e)):i.push(t(o,s))),i),n))}async asyncTransform(t,e){return await Hn(this,t,e)}toJSON(){return this.serialize(cs,fs)}prettyPrint(){return JSON.stringify(this.toJSON(),null,"  ")}tableSize(){return Math.pow(2,this._options.bits)}async _findChild(t){let e=await this._findPlace(t),n=e.bucket._at(e.pos);if(!(n instanceof I)&&n!=null&&n.key===t)return n}async _findPlace(t){let e=this._options.hash(typeof t=="string"?Qt(t):t),n=await e.take(this._options.bits),i=this._children.get(n);return i instanceof I?await i._findPlace(e):{bucket:this,pos:n,hash:e,existingChild:i}}async _findNewBucketAndPos(t){let e=await this._findPlace(t);if(e.existingChild!=null&&e.existingChild.key!==t){let n=new I(this._options,e.bucket,e.pos);e.bucket._putObjectAt(e.pos,n);let i=await n._findPlace(e.existingChild.hash);return i.bucket._putAt(i,e.existingChild.key,e.existingChild.value),await n._findNewBucketAndPos(e.hash)}return e}_putAt(t,e,n){this._putObjectAt(t.pos,{key:e,value:n,hash:t.hash})}_putObjectAt(t,e){this._children.get(t)==null&&this._popCount++,this._children.set(t,e)}_delAt(t){if(t===-1)throw new Error("Invalid position");this._children.get(t)!=null&&this._popCount--,this._children.unset(t),this._level()}_level(){if(this._parent!=null&&this._popCount<=1)if(this._popCount===1){let t=this._children.find(as);if(t!=null&&!(t instanceof I)){let e=t.hash;e.untake(this._options.bits);let n={pos:this._posAtParent,hash:e,bucket:this._parent};this._parent._putAt(n,t.key,t.value)}}else this._parent._delAt(this._posAtParent)}_at(t){return this._children.get(t)}};function as(r){return!!r}function cs(r,t){return r.key}function fs(r){return r}async function Hn(r,t,e){let n=[];for(let i of r._children.compactArray())if(i instanceof I)await Hn(i,t,e);else{let o=await t(i);n.push({bitField:r._children.bitField(),children:o})}return await e(n)}var us=[255,254,252,248,240,224,192,128],hs=[1,3,7,15,31,63,127,255],Zt=class{constructor(t){this._value=t,this._currentBytePos=t.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+this._currentBytePos*8}totalBits(){return this._value.length*8}take(t){let e=t,n=0;for(;e>0&&this._haveBits();){let i=this._value[this._currentBytePos],o=this._currentBitPos+1,s=Math.min(o,e),f=ls(i,o-s,s);n=(n<<s)+f,e-=s,this._currentBitPos-=s,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return n}untake(t){for(this._currentBitPos+=t;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}};function ls(r,t,e){let n=ds(t,e);return(r&n)>>>t}function ds(r,t){return us[r]&hs[Math.min(t+r-1,7)]}function Ft(r,t){t==null&&(t=r.reduce((i,o)=>i+o.length,0));let e=ft(t),n=0;for(let i of r)e.set(i,n),n+=i.length;return ct(e)}function On(r){function t(e){return e instanceof Yt?e:new Yt(e,r)}return t}var Yt=class{constructor(t,e){if(!(t instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=t,this._hashFn=e,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(t){let e=t;for(;this._availableBits<e;)await this._produceMoreBits();let n=0;for(;e>0;){let i=this._buffers[this._currentBufferIndex],o=Math.min(i.availableBits(),e),s=i.take(o);n=(n<<o)+s,e-=o,this._availableBits-=o,i.availableBits()===0&&this._currentBufferIndex++}return n}untake(t){let e=t;for(;e>0;){let n=this._buffers[this._currentBufferIndex],i=Math.min(n.totalBits()-n.availableBits(),e);n.untake(i),e-=i,this._availableBits+=i,this._currentBufferIndex>0&&n.totalBits()===n.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;let t=this._depth>0?Ft([this._value,Uint8Array.from([this._depth])]):this._value,e=await this._hashFn(t),n=new Zt(e);this._buffers.push(n),this._availableBits+=n.availableBits()}};function Rn(r){if(r==null||r.hashFn==null)throw new Error("please define an options.hashFn");let t={bits:r.bits??8,hash:On(r.hashFn)};return new I(t)}var ee=O(Gn(),1);function ps(r){let t=new Array(4);for(let e=0;e<4;e++)t[e]=r&255,r=r>>8;return new Uint8Array(t)}var Kc=st({name:"murmur3-32",code:35,encode:r=>ps(ee.default.x86.hash32(r))}),jn=st({name:"murmur3-128",code:34,encode:r=>pt.fromHex(ee.default.x64.hash128(r))}),Xc=st({name:"murmur3-x64-64",code:34,encode:r=>pt.fromHex(ee.default.x64.hash128(r)).subarray(0,8)});async function ms(r){return(await jn.encode(r)).slice(0,8).reverse()}var $n=BigInt(34),Xe=class extends J{constructor(t,e){super(t,e),this._bucket=Rn({hashFn:ms,bits:8})}async put(t,e){this.cid=void 0,this.size=void 0,this.nodeSize=void 0,await this._bucket.put(t,e)}async get(t){return await this._bucket.get(t)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(let{key:t,value:e}of this._bucket.eachLeafSeries())yield{key:t,child:e}}estimateNodeSize(){return this.nodeSize!==void 0?this.nodeSize:(this.nodeSize=Kn(this._bucket,this,this.options),this.nodeSize)}async*flush(t){for await(let e of Jn(this._bucket,t,this,this.options))yield{...e,path:this.path}}},Wn=Xe;async function*Jn(r,t,e,n){let i=r._children,o=[],s=0n;for(let c=0;c<i.length;c++){let l=i.get(c);if(l==null)continue;let m=c.toString(16).toUpperCase().padStart(2,"0");if(l instanceof I){let S;for await(let d of Jn(l,t,null,n))S=d;if(S==null)throw new Error("Could not flush sharded directory, no subshard found");o.push({Name:m,Tsize:Number(S.size),Hash:S.cid}),s+=S.size}else if(ys(l.value)){let S=l.value,d;for await(let w of S.flush(t))d=w,yield d;if(d==null)throw new Error("Did not flush dir");let y=m+l.key;o.push({Name:y,Tsize:Number(d.size),Hash:d.cid}),s+=d.size}else{let S=l.value;if(S.cid==null)continue;let d=m+l.key,y=S.size;o.push({Name:d,Tsize:Number(y),Hash:S.cid}),s+=BigInt(y??0)}}let f=Uint8Array.from(i.bitField().reverse()),a=new z({type:"hamt-sharded-directory",data:f,fanout:BigInt(r.tableSize()),hashType:$n,mtime:e?.mtime,mode:e?.mode}),h={Data:a.marshal(),Links:o},u=U(F(h)),p=await G(u,t,n),D=BigInt(u.byteLength)+s;yield{cid:p,unixfs:a,size:D}}function ys(r){return typeof r.flush=="function"}function Kn(r,t,e){let n=r._children,i=[];for(let a=0;a<n.length;a++){let h=n.get(a);if(h==null)continue;let u=a.toString(16).toUpperCase().padStart(2,"0");if(h instanceof I){let p=Kn(h,null,e);i.push({Name:u,Tsize:Number(p),Hash:e.cidVersion===0?zt:It})}else if(typeof h.value.flush=="function"){let D=h.value.nodeSize();i.push({Name:u+h.key,Tsize:Number(D),Hash:e.cidVersion===0?zt:It})}else{let p=h.value;if(p.cid==null)continue;let D=u+h.key,c=p.size;i.push({Name:D,Tsize:Number(c),Hash:p.cid})}}let o=Uint8Array.from(n.bitField().reverse()),s=new z({type:"hamt-sharded-directory",data:o,fanout:BigInt(r.tableSize()),hashType:$n,mtime:t?.mtime,mode:t?.mode});return U(F({Data:s.marshal(),Links:i})).length}async function Qe(r,t,e,n){let i=t;t instanceof at&&t.estimateNodeSize()>e&&(i=await gs(t,n));let o=i.parent;if(o!=null){if(i!==t){if(r!=null&&(r.parent=i),i.parentKey==null)throw new Error("No parent key found");await o.put(i.parentKey,i)}return await Qe(i,o,e,n)}return i}async function gs(r,t){let e=new Wn({root:r.root,dir:!0,parent:r.parent,parentKey:r.parentKey,path:r.path,dirty:r.dirty,flat:!1,mtime:r.mtime,mode:r.mode},t);for await(let{key:n,child:i}of r.eachChildSeries())await e.put(n,i);return e}var Xn=(r="")=>(r.trim().match(/([^\\/]|\\\/)+/g)??[]).filter(Boolean);async function ws(r,t,e){let n=Xn(r.path??""),i=n.length-1,o=t,s="";for(let f=0;f<n.length;f++){let a=n[f];s+=`${s!==""?"/":""}${a}`;let h=f===i;if(o.dirty=!0,o.cid=void 0,o.size=void 0,h)await o.put(a,r),t=await Qe(null,o,e.shardSplitThresholdBytes,e);else{let u=await o.get(a);(u==null||!(u instanceof J))&&(u=new at({root:!1,dir:!0,parent:o,parentKey:a,path:s,dirty:!0,flat:!0,mtime:u?.unixfs?.mtime,mode:u?.unixfs?.mode},e)),await o.put(a,u),o=u}}return t}async function*Qn(r,t){if(!(r instanceof J)){r.unixfs?.isDirectory()===!0&&(yield r);return}yield*r.flush(t)}function Zn(r){return async function*(e,n){let i=new at({root:!0,dir:!0,path:"",dirty:!0,flat:!0},r),o,s=!1;for await(let f of e){if(f==null)continue;let a=`${f.originalPath??""}`.split("/")[0];a!=null&&a!==""&&(o==null?(o=a,s=!0):o!==a&&(s=!1)),i=await ws(f,i,r),(f.unixfs==null||!f.unixfs.isDirectory())&&(yield f)}if(r.wrapWithDirectory||s&&i.childCount()>1)yield*Qn(i,n);else for await(let f of i.eachChildSeries())f!=null&&(yield*Qn(f.child,n))}}var Ze=O(_t(),1);var Yn=()=>async function*(t){for await(let e of t){if(e.length===void 0)throw(0,Ze.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT");if(typeof e=="string"||e instanceof String)yield Qt(e.toString());else if(Array.isArray(e))yield Uint8Array.from(e);else if(e instanceof Uint8Array)yield e;else throw(0,Ze.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}};function ti(r,t){if(r===t)return!0;if(r.byteLength!==t.byteLength)return!1;for(let e=0;e<r.byteLength;e++)if(r[e]!==t[e])return!1;return!0}var ri=Symbol.for("@achingbrain/uint8arraylist");function ei(r,t){if(t==null||t<0)throw new RangeError("index is out of bounds");let e=0;for(let n of r){let i=e+n.byteLength;if(t<i)return{buf:n,index:t-e};e=i}throw new RangeError("index is out of bounds")}function re(r){return!!r?.[ri]}var K=class{constructor(...t){Object.defineProperty(this,ri,{value:!0}),this.bufs=[],this.length=0,t.length>0&&this.appendAll(t)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...t){this.appendAll(t)}appendAll(t){let e=0;for(let n of t)if(n instanceof Uint8Array)e+=n.byteLength,this.bufs.push(n);else if(re(n))e+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=e}prepend(...t){this.prependAll(t)}prependAll(t){let e=0;for(let n of t.reverse())if(n instanceof Uint8Array)e+=n.byteLength,this.bufs.unshift(n);else if(re(n))e+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=e}get(t){let e=ei(this.bufs,t);return e.buf[e.index]}set(t,e){let n=ei(this.bufs,t);n.buf[n.index]=e}write(t,e=0){if(t instanceof Uint8Array)for(let n=0;n<t.length;n++)this.set(e+n,t[n]);else if(re(t))for(let n=0;n<t.length;n++)this.set(e+n,t.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(t){if(t=Math.trunc(t),!(Number.isNaN(t)||t<=0)){if(t===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(t>=this.bufs[0].byteLength)t-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(t),this.length-=t;break}}}slice(t,e){let{bufs:n,length:i}=this._subList(t,e);return Ft(n,i)}subarray(t,e){let{bufs:n,length:i}=this._subList(t,e);return n.length===1?n[0]:Ft(n,i)}sublist(t,e){let{bufs:n,length:i}=this._subList(t,e),o=new K;return o.length=i,o.bufs=n,o}_subList(t,e){if(t=t??0,e=e??this.length,t<0&&(t=this.length+t),e<0&&(e=this.length+e),t<0||e>this.length)throw new RangeError("index is out of bounds");if(t===e)return{bufs:[],length:0};if(t===0&&e===this.length)return{bufs:[...this.bufs],length:this.length};let n=[],i=0;for(let o=0;o<this.bufs.length;o++){let s=this.bufs[o],f=i,a=f+s.byteLength;if(i=a,t>=a)continue;let h=t>=f&&t<a,u=e>f&&e<=a;if(h&&u){if(t===f&&e===a){n.push(s);break}let p=t-f;n.push(s.subarray(p,p+(e-t)));break}if(h){if(t===0){n.push(s);continue}n.push(s.subarray(t-f));continue}if(u){if(e===a){n.push(s);break}n.push(s.subarray(0,e-f));break}n.push(s)}return{bufs:n,length:e-t}}indexOf(t,e=0){if(!re(t)&&!(t instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');let n=t instanceof Uint8Array?t:t.subarray();if(e=Number(e??0),isNaN(e)&&(e=0),e<0&&(e=this.length+e),e<0&&(e=0),t.length===0)return e>this.length?this.length:e;let i=n.byteLength;if(i===0)throw new TypeError("search must be at least 1 byte long");let o=256,s=new Int32Array(o);for(let p=0;p<o;p++)s[p]=-1;for(let p=0;p<i;p++)s[n[p]]=p;let f=s,a=this.byteLength-n.byteLength,h=n.byteLength-1,u;for(let p=e;p<=a;p+=u){u=0;for(let D=h;D>=0;D--){let c=this.get(p+D);if(n[D]!==c){u=Math.max(1,D-f[c]);break}}if(u===0)return p}return-1}getInt8(t){let e=this.subarray(t,t+1);return new DataView(e.buffer,e.byteOffset,e.byteLength).getInt8(0)}setInt8(t,e){let n=ft(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,e),this.write(n,t)}getInt16(t,e){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,e)}setInt16(t,e,n){let i=Z(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt16(0,e,n),this.write(i,t)}getInt32(t,e){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,e)}setInt32(t,e,n){let i=Z(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt32(0,e,n),this.write(i,t)}getBigInt64(t,e){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,e)}setBigInt64(t,e,n){let i=Z(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigInt64(0,e,n),this.write(i,t)}getUint8(t){let e=this.subarray(t,t+1);return new DataView(e.buffer,e.byteOffset,e.byteLength).getUint8(0)}setUint8(t,e){let n=ft(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,e),this.write(n,t)}getUint16(t,e){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,e)}setUint16(t,e,n){let i=Z(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint16(0,e,n),this.write(i,t)}getUint32(t,e){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,e)}setUint32(t,e,n){let i=Z(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,e,n),this.write(i,t)}getBigUint64(t,e){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,e)}setBigUint64(t,e,n){let i=Z(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigUint64(0,e,n),this.write(i,t)}getFloat32(t,e){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,e)}setFloat32(t,e,n){let i=Z(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat32(0,e,n),this.write(i,t)}getFloat64(t,e){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,e)}setFloat64(t,e,n){let i=Z(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat64(0,e,n),this.write(i,t)}equals(t){if(t==null||!(t instanceof K)||t.bufs.length!==this.bufs.length)return!1;for(let e=0;e<this.bufs.length;e++)if(!ti(this.bufs[e],t.bufs[e]))return!1;return!0}static fromUint8Arrays(t,e){let n=new K;return n.bufs=t,e==null&&(e=t.reduce((i,o)=>i+o.byteLength,0)),n.length=e,n}};var bs=262144,ni=(r={})=>{let t=r.chunkSize??bs;return async function*(n){let i=new K,o=0,s=!1;for await(let f of n)for(i.append(f),o+=f.length;o>=t;)if(yield i.slice(0,t),s=!0,t===i.length)i=new K,o=0;else{let a=new K;a.append(i.sublist(t)),i=a,o-=t}(!s||o>0)&&(yield i.subarray(0,o))}};var xs=174;function Ye(r){let t=r?.maxChildrenPerNode??xs;return async function e(n,i){let o=[];for await(let s of bt(n,t))o.push(await i(s));return o.length>1?await e(o,i):o[0]}}function ii(r){return async function*(e,n){let i=0n;for await(let o of e.content)yield async()=>{let s,f={codec:Ct,cidVersion:r.cidVersion,onProgress:r.onProgress};r.rawLeaves?(f.codec=Pt,f.cidVersion=1):(s=new z({type:r.leafType,data:o}),o=U({Data:s.marshal(),Links:[]}));let a=await G(o,n,f);return i+=BigInt(o.byteLength),r.onProgress?.(new Q("unixfs:importer:progress:file:write",{bytesWritten:i,cid:a,path:e.path})),{cid:a,unixfs:s,size:BigInt(o.length),block:o}}}}function _s(r){return r[Symbol.asyncIterator]!=null}function vs(r){if(_s(r))return(async()=>{for await(let t of r)return t})();for(let t of r)return t}var tr=vs;var er=O(_t(),1);async function*rr(r,t,e={}){let n;Symbol.asyncIterator in r||Symbol.iterator in r?n=r:n=[r];let i=e.wrapWithDirectory??!1,o=e.shardSplitThresholdBytes??262144,s=e.cidVersion??1,f=e.rawLeaves??!0,a=e.leafType??"file",h=e.fileImportConcurrency??50,u=e.blockWriteConcurrency??10,p=e.reduceSingleLeafToSelf??!0,D=e.chunker??ni(),c=e.chunkValidator??Yn(),l=e.dagBuilder??En({chunker:D,chunkValidator:c,wrapWithDirectory:i,layout:e.layout??Ye(),bufferImporter:e.bufferImporter??ii({cidVersion:s,rawLeaves:f,leafType:a,onProgress:e.onProgress}),blockWriteConcurrency:u,reduceSingleLeafToSelf:p,cidVersion:s,onProgress:e.onProgress}),m=e.treeBuilder??Zn({wrapWithDirectory:i,shardSplitThresholdBytes:o,cidVersion:s,onProgress:e.onProgress});for await(let S of m(xt(l(n,t),h),t))yield{cid:S.cid,path:S.path,unixfs:S.unixfs,size:S.size}}async function nr(r,t,e={}){let n=await tr(rr([r],t,e));if(n==null)throw(0,er.default)(new Error("Nothing imported"),"ERR_INVALID_PARAMS");return n}async function Bs(r,t,e={}){let n=await tr(rr([r],t,e));if(n==null)throw(0,er.default)(new Error("Nothing imported"),"ERR_INVALID_PARAMS");return n}async function As(r,t,e={}){return await nr({content:r},t,e)}async function ks(r,t,e={}){return await nr({content:r},t,e)}return ui(Ss);})();
return IpfsUnixfsImporter}));
