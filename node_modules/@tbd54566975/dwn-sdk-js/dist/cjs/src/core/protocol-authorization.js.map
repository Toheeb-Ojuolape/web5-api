{"version":3,"file":"protocol-authorization.js","sourceRoot":"","sources":["../../../../src/core/protocol-authorization.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMA,oFAA+E;AAC/E,+CAAwD;AACxD,2CAAwE;AACxE,6DAAiF;AAEjF,IAAM,wBAAwB;IAC5B,GAAC,0BAAa,CAAC,KAAK,IAAI,yBAAc,CAAC,KAAK;IAC5C,GAAC,0BAAa,CAAC,IAAI,IAAK,yBAAc,CAAC,IAAI;OAC5C,CAAC;AAEF;IAAA;IA8YA,CAAC;IA5YC;;;OAGG;IACiB,+BAAS,GAA7B,UACE,MAAc,EACd,eAA2C,EAC3C,MAA0B,EAC1B,YAA0B;;;;;4BAIxB,qBAAM,qBAAqB,CAAC,6BAA6B,CAAC,MAAM,EAAE,eAAe,EAAE,YAAY,CAAC,EAAA;;wBAD5F,oBAAoB,GACxB,SAAgG;wBAGvE,qBAAM,qBAAqB,CAAC,uBAAuB,CAC5E,MAAM,EACN,eAAe,EACf,oBAAoB,EACpB,YAAY,CACb,EAAA;;wBALK,kBAAkB,GAAG,SAK1B;wBAED,0BAA0B;wBAC1B,qBAAqB,CAAC,kBAAkB,CACtC,eAAe,EACf,oBAAoB,EACpB,kBAAkB,CAAC,KAAK,CACzB,CAAC;wBAGI,qBAAqB,GAAG,qBAAqB,CAAC,UAAU,CAC5D,eAAe,CAAC,OAAO,EACvB,kBAAkB,EAClB,oBAAoB,CACrB,CAAC;wBAEF,qBAAqB,CAAC,UAAU,CAC9B,eAAe,CAAC,OAAO,EACvB,kBAAkB,CAAC,KAAK,CACzB,CAAC;wBAEF,oDAAoD;wBACpD,qBAAqB,CAAC,oBAAoB,CACxC,MAAM,EACN,MAAM,EACN,eAAe,CAAC,OAAO,CAAC,UAAU,CAAC,MAAM,EACzC,qBAAqB,EACrB,oBAAoB,CACrB,CAAC;wBAEF,+CAA+C;wBAC/C,qBAAM,qBAAqB,CAAC,qBAAqB,CAAC,MAAM,EAAE,eAAe,EAAE,YAAY,CAAC,EAAA;;wBADxF,+CAA+C;wBAC/C,SAAwF,CAAC;;;;;KAC1F;IAED;;OAEG;IACkB,6CAAuB,GAA5C,UACE,MAAc,EACd,eAA2C,EAC3C,oBAA2C,EAC3C,YAA0B;;;;;;wBAI1B,IAAI,eAAe,CAAC,OAAO,CAAC,UAAU,CAAC,MAAM,KAAK,0BAAa,CAAC,KAAK,EAAE;4BACrE,WAAW,GAAI,eAAgC,CAAC,OAAO,CAAC,UAAU,CAAC,QAAS,CAAC;yBAC9E;6BAAM;4BACL,WAAW,GAAG,oBAAoB,CAAC,oBAAoB,CAAC,MAAM,GAAC,CAAC,CAAC,CAAC,UAAU,CAAC,QAAS,CAAC;yBACxF;wBAGK,KAAK,GAAW;4BACpB,SAAS,EAAG,6BAAgB,CAAC,SAAS;4BACtC,MAAM,EAAM,0BAAa,CAAC,SAAS;4BACnC,QAAQ,EAAI,WAAW;yBACxB,CAAC;wBACgB,qBAAM,YAAY,CAAC,KAAK,CAAC,MAAM,EAAE,KAAK,CAAC,EAAA;;wBAAnD,SAAS,GAAG,SAAsE;wBAExF,IAAI,SAAS,CAAC,MAAM,KAAK,CAAC,EAAE;4BAC1B,MAAM,IAAI,KAAK,CAAC,iDAA0C,WAAW,CAAE,CAAC,CAAC;yBAC1E;wBAEK,eAAe,GAAG,SAAS,CAAC,CAAC,CAAC,CAAC;wBACrC,sBAAO,eAAe,CAAC,UAAU,CAAC,UAAU,EAAC;;;;KAC9C;IAED;;;OAGG;IACkB,mDAA6B,GAAlD,UACE,MAAc,EACd,eAA2C,EAC3C,YAA0B;;;;;;wBAGpB,oBAAoB,GAA0B,EAAE,CAAC;6BAInD,CAAA,eAAe,CAAC,OAAO,CAAC,UAAU,CAAC,MAAM,KAAK,0BAAa,CAAC,KAAK,CAAA,EAAjE,wBAAiE;wBACnE,YAAY,GAAG,eAA+B,CAAC;;;wBAEzC,WAAW,GAAG,eAA8B,CAAC;wBAC7C,KAAK,GAAG;4BACZ,SAAS,EAAG,6BAAgB,CAAC,OAAO;4BACpC,MAAM,EAAM,0BAAa,CAAC,KAAK;4BAC/B,QAAQ,EAAI,WAAW,CAAC,OAAO,CAAC,UAAU,CAAC,QAAQ;yBACpD,CAAC;wBACuB,qBAAM,YAAY,CAAC,KAAK,CAAC,MAAM,EAAE,KAAK,CAAC,EAAA;;wBAA1D,gBAAgB,GAAG,SAA+D;wBAC5D,qBAAM,+BAAY,CAAC,gBAAgB,CAAC,gBAAgB,CAAC,EAAA;;wBAA3E,mBAAmB,GAAG,SAA4E;wBACzF,qBAAM,+BAAY,CAAC,KAAK,CAAC,mBAAmB,CAAC,EAAA;;wBAA5D,YAAY,GAAG,SAA6C,CAAC;wBAC7D,oBAAoB,CAAC,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,CAAC;;;wBAG5C,QAAQ,GAAG,YAAY,CAAC,OAAO,CAAC,UAAU,CAAC,QAAS,CAAC;wBACrD,SAAS,GAAG,YAAY,CAAC,OAAO,CAAC,SAAU,CAAC;wBAG9C,eAAe,GAAG,YAAY,CAAC,OAAO,CAAC,UAAU,CAAC,QAAQ,CAAC;;;6BACxD,CAAA,eAAe,KAAK,SAAS,CAAA;wBAE5B,KAAK,GAAW;4BACpB,SAAS,EAAG,6BAAgB,CAAC,OAAO;4BACpC,MAAM,EAAM,0BAAa,CAAC,KAAK;4BAC/B,QAAQ,UAAA;4BACR,SAAS,WAAA;4BACT,QAAQ,EAAI,eAAe;yBAC5B,CAAC;wBACqB,qBAAM,YAAY,CAAC,KAAK,CAAC,MAAM,EAAE,KAAK,CAAC,EAAA;;wBAAxD,cAAc,GAAG,SAAgE;wBAEvF,IAAI,cAAc,CAAC,MAAM,KAAK,CAAC,EAAE;4BAC/B,MAAM,IAAI,KAAK,CAAC,kCAA2B,eAAe,CAAE,CAAC,CAAC;yBAC/D;wBAEK,WAAS,cAAc,CAAC,CAAC,CAAC,CAAC;wBACjC,oBAAoB,CAAC,IAAI,CAAC,QAAM,CAAC,CAAC;wBAElC,eAAe,GAAG,QAAM,CAAC,UAAU,CAAC,QAAQ,CAAC;;4BAG/C,sBAAO,oBAAoB,CAAC,OAAO,EAAE,EAAC,CAAC,sBAAsB;;;;KAC9D;IAED;;OAEG;IACY,gCAAU,GAAzB,UACE,cAAwD,EACxD,kBAAsC,EACtC,oBAA2C;QAE3C,IAAI,YAAoB,CAAC;QACzB,IAAI,cAAc,CAAC,UAAU,CAAC,MAAM,KAAK,0BAAa,CAAC,KAAK,EAAE;YAC5D,YAAY,GAAI,cAAsC,CAAC,UAAU,CAAC,YAAa,CAAC;SACjF;aAAM;YACL,YAAY,GAAG,oBAAoB,CAAC,oBAAoB,CAAC,MAAM,GAAC,CAAC,CAAC,CAAC,UAAU,CAAC,YAAa,CAAC;SAC7F;QACD,IAAM,iBAAiB,GAAG,YAAY,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QAElD,wCAAwC;QACxC,IAAI,cAAc,GAAoB,kBAAkB,CAAC,SAAS,CAAC;QACnE,IAAI,CAAC,GAAG,CAAC,CAAC;QACV,OAAO,CAAC,GAAG,iBAAiB,CAAC,MAAM,EAAE;YACnC,IAAM,eAAe,GAAG,iBAAiB,CAAC,CAAC,CAAC,CAAC;YAC7C,IAAM,WAAW,GAAgC,cAAc,CAAC,eAAe,CAAC,CAAC;YAEjF,IAAI,WAAW,KAAK,SAAS,EAAE;gBAC7B,IAAM,mBAAmB,GAAG,iBAAiB,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;gBACxE,MAAM,IAAI,uBAAQ,CAAC,2BAAY,CAAC,mCAAmC,EACjE,+CAAwC,mBAAmB,CAAE,CAAC,CAAC;aAClE;YAED,cAAc,GAAG,WAAW,CAAC;YAC7B,CAAC,EAAE,CAAC;SACL;QAED,OAAO,cAAc,CAAC;IACxB,CAAC;IAED;;;OAGG;IACY,wCAAkB,GAAjC,UACE,cAA0C,EAC1C,oBAA2C,EAC3C,KAAoB;;QAEpB,kDAAkD;QAClD,IAAI,cAAc,CAAC,OAAO,CAAC,UAAU,CAAC,MAAM,KAAK,0BAAa,CAAC,KAAK,EAAE;YACpE,OAAO;SACR;QAED,IAAM,SAAS,GAAG,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACrC,IAAM,oBAAoB,GAAI,cAA+B,CAAC,OAAO,CAAC,UAAU,CAAC,YAAa,CAAC;QAC/F,IAAM,gBAAgB,GAAG,qBAAqB,CAAC,WAAW,CAAC,oBAAoB,CAAC,CAAC;QACjF,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,gBAAgB,CAAC,EAAE;YACzC,MAAM,IAAI,uBAAQ,CAAC,2BAAY,CAAC,gCAAgC,EAC9D,2BAAoB,gBAAgB,6BAA0B,CAAC,CAAC;SACnE;QAED,IAAI,oBAAoB,GAAW,EAAE,CAAC;;YACtC,KAAuB,IAAA,yBAAA,SAAA,oBAAoB,CAAA,0DAAA,4FAAE;gBAAxC,IAAM,QAAQ,iCAAA;gBACjB,IAAM,YAAY,GAAG,QAAQ,CAAC,UAAU,CAAC,YAAa,CAAC;gBACvD,IAAM,gBAAgB,GAAG,qBAAqB,CAAC,WAAW,CAAC,YAAY,CAAC,CAAC;gBACzE,oBAAoB,IAAI,UAAG,gBAAgB,MAAG,CAAC,CAAC,6CAA6C;aAC9F;;;;;;;;;QAED,IAAM,kBAAkB,GAAG,oBAAoB,GAAG,gBAAgB,CAAC,CAAC,qBAAqB;QAEzF,IAAI,oBAAoB,KAAK,kBAAkB,EAAE;YAC/C,MAAM,IAAI,uBAAQ,CAChB,2BAAY,CAAC,0CAA0C,EACvD,kCAA2B,oBAAoB,wDAA8C,kBAAkB,OAAI,CACpH,CAAC;SACH;IACH,CAAC;IAED;;;;OAIG;IACY,gCAAU,GAAzB,UACE,cAAwD,EACxD,aAA4B;QAE5B,kDAAkD;QAClD,IAAI,cAAc,CAAC,UAAU,CAAC,MAAM,KAAK,0BAAa,CAAC,KAAK,EAAE;YAC5D,OAAO;SACR;QACD,IAAM,mBAAmB,GAAG,cAAqC,CAAC;QAElE,IAAM,YAAY,GAAG,mBAAmB,CAAC,UAAU,CAAC,YAAa,CAAC;QAClE,wDAAwD;QACxD,IAAM,QAAQ,GAAG,qBAAqB,CAAC,WAAW,CAAC,YAAY,CAAC,CAAC;QACjE,IAAM,YAAY,GAAiB,aAAa,CAAC,QAAQ,CAAC,CAAC;QAE3D,gFAAgF;QACxE,IAAA,MAAM,GAAK,mBAAmB,CAAC,UAAU,OAAnC,CAAoC;QAClD,IAAI,YAAY,CAAC,MAAM,KAAK,SAAS,IAAI,YAAY,CAAC,MAAM,KAAK,MAAM,EAAE;YACvE,MAAM,IAAI,uBAAQ,CAChB,2BAAY,CAAC,kCAAkC,EAC/C,gBAAS,QAAQ,iCAAuB,YAAY,CAAC,MAAM,qCAC5C,MAAM,MAAG,CACzB,CAAC;SACH;QAED,2FAA2F;QACnF,IAAA,UAAU,GAAK,mBAAmB,CAAC,UAAU,WAAnC,CAAoC;QACtD,IAAI,YAAY,CAAC,WAAW,KAAK,SAAS,IAAI,CAAC,YAAY,CAAC,WAAW,CAAC,QAAQ,CAAC,UAAU,CAAC,EAAE;YAC5F,MAAM,IAAI,uBAAQ,CAChB,2BAAY,CAAC,wCAAwC,EACrD,gBAAS,QAAQ,yCAA+B,YAAY,CAAC,WAAW,qCACzD,UAAU,MAAG,CAC7B,CAAC;SACH;IACH,CAAC;IAED;;;OAGG;IACY,0CAAoB,GAAnC,UACE,MAAc,EACd,MAA0B,EAC1B,qBAAoC,EACpC,qBAAsC,EACtC,oBAA2C;;QAE3C,IAAM,WAAW,GAAG,qBAAqB,CAAC,QAAQ,CAAC;QAEnD,IAAI,WAAW,KAAK,SAAS,EAAE;YAC7B,+DAA+D;YAC/D,IAAI,MAAM,KAAK,MAAM,EAAE;gBACrB,OAAO;aACR;iBAAM;gBACL,MAAM,IAAI,KAAK,CAAC,qCAA8B,qBAAqB,eAAK,MAAM,qBAAkB,CAAC,CAAC;aACnG;SACF;QAED,IAAM,cAAc,GAAG,IAAI,GAAG,EAAU,CAAC;;YACzC,KAAyB,IAAA,gBAAA,SAAA,WAAW,CAAA,wCAAA,iEAAE;gBAAjC,IAAM,UAAU,wBAAA;gBACnB,QAAQ,UAAU,CAAC,GAAG,EAAE;oBACxB,KAAK,wBAAa,CAAC,MAAM;wBACvB,cAAc,CAAC,GAAG,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;wBACnC,MAAM;oBACR,KAAK,wBAAa,CAAC,MAAM;wBACvB,IAAM,qBAAqB,GAAG,qBAAqB,CAAC,UAAU,CAC5D,oBAAoB,EACpB,UAAU,CAAC,EAAG,CACf,CAAC;wBAEF,IAAI,qBAAqB,KAAK,SAAS,EAAE;4BACvC,IAAM,cAAc,GAAG,oBAAO,CAAC,SAAS,CAAC,qBAAqB,CAAC,CAAC;4BAEhE,IAAI,MAAM,KAAK,cAAc,EAAE;gCAC7B,cAAc,CAAC,GAAG,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;6BACpC;yBACF;wBACD,MAAM;oBACR,KAAK,wBAAa,CAAC,SAAS;wBAC1B,IAAM,wBAAwB,GAAG,qBAAqB,CAAC,UAAU,CAC/D,oBAAoB,EAClB,UAAU,CAAC,EAAG,CACjB,CAAC;wBACF,IAAI,wBAAwB,KAAK,SAAS,EAAE;4BAC1C,IAAM,cAAc,GAAG,wBAAwB,CAAC,UAAU,CAAC,SAAS,CAAC;4BAErE,IAAI,MAAM,KAAK,cAAc,EAAE;gCAC7B,cAAc,CAAC,GAAG,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC;6BACpC;yBACF;wBACD,MAAM;oBACN,WAAW;oBACX,kEAAkE;iBACnE;aACF;;;;;;;;;QAED,IAAM,oBAAoB,GAAG,wBAAwB,CAAC,qBAAqB,CAAC,CAAC;QAC7E,IAAI,CAAC,cAAc,CAAC,GAAG,CAAC,oBAAoB,CAAC,EAAE;YAC7C,MAAM,IAAI,KAAK,CAAC,kCAA2B,oBAAoB,+CAAqC,KAAI,KAAK,YAAL,KAAK,iCAAI,cAAc,cAAE,IAAI,CAAC,GAAG,CAAC,MAAG,CAAC,CAAC;SAChJ;IACH,CAAC;IAED;;;;OAIG;IACkB,2CAAqB,GAA1C,UAA2C,MAAc,EAAE,eAA2C,EAAE,YAA0B;;;;;;6BAC5H,CAAA,eAAe,CAAC,OAAO,CAAC,UAAU,CAAC,MAAM,KAAK,0BAAa,CAAC,IAAI,CAAA,EAAhE,wBAAgE;;;6BAEzD,CAAA,eAAe,CAAC,OAAO,CAAC,UAAU,CAAC,MAAM,KAAK,0BAAa,CAAC,KAAK,CAAA,EAAjE,wBAAiE;wBACpE,YAAY,GAAG,eAA+B,CAAC;wBAC9B,qBAAM,YAAY,CAAC,cAAc,EAAE,EAAA;;wBAApD,cAAc,GAAG,SAAmC;6BACtD,CAAC,cAAc,EAAf,wBAAe;wBAEX,KAAK,GAAG;4BACZ,OAAO,EAAE,YAAY,CAAC,OAAO,CAAC,QAAQ;yBACvC,CAAC;wBACa,qBAAM,YAAY,CAAC,KAAK,CAAC,MAAM,EAAE,KAAK,CAAC,EAAA;;wBAAhD,MAAM,GAAG,SAAgE;wBAGzE,YAAY,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;wBACzB,oBAAoB,GAAG,oBAAO,CAAC,SAAS,CAAC,YAAY,CAAC,CAAC;wBAC7D,IAAI,YAAY,CAAC,MAAM,KAAK,oBAAoB,EAAE;4BAChD,MAAM,IAAI,KAAK,CAAC,sCAA+B,YAAY,CAAC,MAAM,sDAA4C,oBAAoB,MAAG,CAAC,CAAC;yBACxI;;;;;;KAGN;IAED;;;;;;;OAOG;IACY,gCAAU,GAAzB,UACE,oBAA2C,EAC3C,YAAoB;QAEpB,IAAM,iBAAiB,GAAG,YAAY,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QAElD,qEAAqE;QACrE,IAAI,iBAAiB,CAAC,MAAM,GAAG,oBAAoB,CAAC,MAAM,EAAE;YAC1D,OAAO,SAAS,CAAC;SAClB;QAED,IAAI,CAAC,GAAG,CAAC,CAAC;QACV,OAAO,IAAI,EAAE;YACX,IAAM,oBAAoB,GAAG,iBAAiB,CAAC,CAAC,CAAC,CAAC;YAClD,IAAM,eAAe,GAAG,oBAAoB,CAAC,CAAC,CAAC,CAAC;YAEhD,IAAM,kBAAkB,GAAG,qBAAqB,CAAC,WAAW,CAAC,eAAe,CAAC,UAAU,CAAC,YAAa,CAAC,CAAC;YACvG,IAAI,kBAAkB,KAAK,oBAAoB,EAAE;gBAC/C,MAAM,IAAI,KAAK,CAAC,+CAAwC,oBAAoB,yBAAe,kBAAkB,CAAE,CAAC,CAAC;aAClH;YAED,wFAAwF;YACxF,IAAI,CAAC,GAAG,CAAC,KAAK,iBAAiB,CAAC,MAAM,EAAE;gBACtC,OAAO,eAAe,CAAC;aACxB;YAED,CAAC,EAAE,CAAC;SACL;IACH,CAAC;IAEc,iCAAW,GAA1B,UAA2B,YAAoB;QAC7C,OAAO,YAAY,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;IAC9C,CAAC;IACH,4BAAC;AAAD,CAAC,AA9YD,IA8YC;AA9YY,sDAAqB"}